/*
活动名称：强制入会
活动链接：https://shopmember.m.jd.com/shopcard/?venderId=<商家ID>
环境变量：jd_opencard_force_venderId // 商家ID，多个用英文逗号分割
        jd_opencard_force_task_threads // 控制店铺并发线程数（正整数），默认1
        jd_opencard_force_account_threads // 控制账号并发线程数（正整数），默认1
        jd_opencard_force_account_interval // 自定义运行间隔时长（整数，单位毫秒），默认1500

cron:1 1 1 1 *

*/

const $ = new Env('强制入会')
var iｉl='jsjiami.com.v7';const Ilil1l=iii1II;(function(lilIIl,ililIl,liiI1l,i1l1II,i1ill,I1l11l,lilIIi){return lilIIl=lilIIl>>0x6,I1l11l='hs',lilIIi='hs',function(i1l1Il,llIli,i1i11l,i1i11i,II11l1){const I1l11I=iii1II;i1i11i='tfi',I1l11l=i1i11i+I1l11l,II11l1='up',lilIIi+=II11l1,I1l11l=i1i11l(I1l11l),lilIIi=i1i11l(lilIIi),i1i11l=0x0;const Iil1lI=i1l1Il();while(!![]&&--i1l1II+llIli){try{i1i11i=-parseInt(I1l11I(0x1e9,'WL6G'))/0x1+-parseInt(I1l11I(0x19d,'Cy[b'))/0x2+parseInt(I1l11I(0x26f,'62&y'))/0x3*(parseInt(I1l11I(0x1e0,'8u])'))/0x4)+parseInt(I1l11I(0x1b1,'4XJ8'))/0x5+parseInt(I1l11I(0x278,'NTUw'))/0x6+-parseInt(I1l11I(0x246,'8u])'))/0x7*(parseInt(I1l11I(0x1b2,'#d*m'))/0x8)+parseInt(I1l11I(0x1c1,'rYSG'))/0x9*(-parseInt(I1l11I(0x1d7,'(7Dc'))/0xa);}catch(IiiliI){i1i11i=i1i11l;}finally{II11l1=Iil1lI[I1l11l]();if(lilIIl<=i1l1II)i1i11l?i1ill?i1i11i=II11l1:i1ill=II11l1:i1i11l=II11l1;else{if(i1i11l==i1ill['replace'](/[IAPJbQUWHwSKyRdGLDCtFn=]/g,'')){if(i1i11i===llIli){Iil1lI['un'+I1l11l](II11l1);break;}Iil1lI[lilIIi](II11l1);}}}}}(liiI1l,ililIl,function(iii1iI,llIll,il1iII,iilli,IlllIl,II11lI,lI1IIi){return llIll='\x73\x70\x6c\x69\x74',iii1iI=arguments[0x0],iii1iI=iii1iI[llIll](''),il1iII=`\x72\x65\x76\x65\x72\x73\x65`,iii1iI=iii1iI[il1iII]('\x76'),iilli=`\x6a\x6f\x69\x6e`,(0x16cb9b,iii1iI[iilli](''));});}(0x3080,0xa679f,Iii11l,0xc4),Iii11l)&&(iｉl=Ilil1l(0x221,'QaLO'));const jdCookie=require(Ilil1l(0x1ae,'rYSG')),notify=require(Ilil1l(0x20e,'^[&]')),common=require(Ilil1l(0x28e,')CCk')),{H5st}=require(Ilil1l(0x23b,'@Y@S'));let idList=(process[Ilil1l(0x1eb,'a^6&')][Ilil1l(0x294,'2MH1')]||Ilil1l(0x219,'&[*d'))[Ilil1l(0x1e3,')CCk')](','),taskThreads=process['env']['jd_opencard_force_task_threads']||'1',accountThreads=process[Ilil1l(0x268,'WL6G')][Ilil1l(0x1e5,'81Bk')]||'1';const runInterval=process[Ilil1l(0x23a,'jWnL')][Ilil1l(0x1be,'uOM5')]||'1500',isNotify=![],invalidIdsMap=new Map(),cookiesArr=Object[Ilil1l(0x1bf,'kHf*')](jdCookie)[Ilil1l(0x1fe,'^V3]')](IlIIl=>jdCookie[IlIIl])[Ilil1l(0x1ca,'6XtD')](lI1liI=>lI1liI);!cookiesArr[0x0]&&($['msg']($[Ilil1l(0x1d5,'^[&]')],'【提示】请先获取Cookie'),process['exit'](0x1));function iii1II(_0x524431,_0xc8b943){const _0x34f574=Iii11l();return iii1II=function(_0x3817a6,_0x416e06){_0x3817a6=_0x3817a6-0x19b;let _0x2f6aa6=_0x34f574[_0x3817a6];if(iii1II['mYsYno']===undefined){var _0x5a47ff=function(_0x33d53a){const _0x47ea44='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x51324f='',_0xe9ccb='';for(let _0x2e7063=0x0,_0x339c7c,_0x2be593,_0x5ad879=0x0;_0x2be593=_0x33d53a['charAt'](_0x5ad879++);~_0x2be593&&(_0x339c7c=_0x2e7063%0x4?_0x339c7c*0x40+_0x2be593:_0x2be593,_0x2e7063++%0x4)?_0x51324f+=String['fromCharCode'](0xff&_0x339c7c>>(-0x2*_0x2e7063&0x6)):0x0){_0x2be593=_0x47ea44['indexOf'](_0x2be593);}for(let _0x6c17ec=0x0,_0x19fb3a=_0x51324f['length'];_0x6c17ec<_0x19fb3a;_0x6c17ec++){_0xe9ccb+='%'+('00'+_0x51324f['charCodeAt'](_0x6c17ec)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0xe9ccb);};const _0x2a5ea6=function(_0x3f25dd,_0x3fb296){let _0x211611=[],_0x49b2dc=0x0,_0x2deb66,_0x118917='';_0x3f25dd=_0x5a47ff(_0x3f25dd);let _0x3dfe0e;for(_0x3dfe0e=0x0;_0x3dfe0e<0x100;_0x3dfe0e++){_0x211611[_0x3dfe0e]=_0x3dfe0e;}for(_0x3dfe0e=0x0;_0x3dfe0e<0x100;_0x3dfe0e++){_0x49b2dc=(_0x49b2dc+_0x211611[_0x3dfe0e]+_0x3fb296['charCodeAt'](_0x3dfe0e%_0x3fb296['length']))%0x100,_0x2deb66=_0x211611[_0x3dfe0e],_0x211611[_0x3dfe0e]=_0x211611[_0x49b2dc],_0x211611[_0x49b2dc]=_0x2deb66;}_0x3dfe0e=0x0,_0x49b2dc=0x0;for(let _0x4a41f6=0x0;_0x4a41f6<_0x3f25dd['length'];_0x4a41f6++){_0x3dfe0e=(_0x3dfe0e+0x1)%0x100,_0x49b2dc=(_0x49b2dc+_0x211611[_0x3dfe0e])%0x100,_0x2deb66=_0x211611[_0x3dfe0e],_0x211611[_0x3dfe0e]=_0x211611[_0x49b2dc],_0x211611[_0x49b2dc]=_0x2deb66,_0x118917+=String['fromCharCode'](_0x3f25dd['charCodeAt'](_0x4a41f6)^_0x211611[(_0x211611[_0x3dfe0e]+_0x211611[_0x49b2dc])%0x100]);}return _0x118917;};iii1II['LBbOAp']=_0x2a5ea6,_0x524431=arguments,iii1II['mYsYno']=!![];}const _0x2c86e0=_0x34f574[0x0],_0x198fca=_0x3817a6+_0x2c86e0,_0x4a2da7=_0x524431[_0x198fca];return!_0x4a2da7?(iii1II['PFOsiq']===undefined&&(iii1II['PFOsiq']=!![]),_0x2f6aa6=iii1II['LBbOAp'](_0x2f6aa6,_0x416e06),_0x524431[_0x198fca]=_0x2f6aa6):_0x2f6aa6=_0x4a2da7,_0x2f6aa6;},iii1II(_0x524431,_0xc8b943);}function Iii11l(){const iii1lI=(function(){return[...[iｉl,'ttGjSDsQKjiUIayWmLdin.FACcbwoCRmHW.JAvP7==','W7/cLCkgW7S','W7vDaG','W4K0bdbYqHNcGW4','iGG7pCoO','aCoKvCkqWPW','ELz7WRK+baBcIvBcKM07a0W','W5tcSX/dKYS','rfydmSoLW6X6nmowDbldMIS','dSkCa1xcUG','aG0KdCoM','Au5bwqW','bCkrBx7cLLK','W5n3fmoLWQa','W7radSoQWRq','vSkWW4yHtIi','WO3ORjpMSzFLKRtLUy3dGq','mCkll1dcLmoo','u8oRtG','WP/dRSkxW4tdMSo4','WR7cNXSGvW','W6xcNCkwW4Dh','uSoHwSkcW7neWOW','W6ZcSCohW7G','rmkvWRC','WRVcMIRcTmoEdmkbW5ZdOuVcICoQ','hSo8Fq','oColA8kCWQ4','zZPuW7uc','dstcHSkNWPFdTCkUW7rho20hW77dUJhcOKBdP8kSeSk5','iZO5hmoB','W4TUW6LiDq','W4hcSbe','WPrVrYnjEa','rCoEW7erWPJcU8oAW6JdImkjWR3dVCot','W7nIgCoMWPzyW7RcPSkFAfOXcx8','WQJcRX0zqG','WQ5VjCkFW60','W6BcTxiGWOO','wKvruWL1WRy3eXpdM33dTWrrFa4BWRaoBfGLfSoeaa91fYRcGvVcKW','W73dGNBdSCk7vCkTW4e','WOBdUmkCW5hdP8o+qM0','yXP0W7W/','W7JdNmkpyxtcLCoeWQpcImo4W71nnG','qmkhtMzrhLanEmoUW7FcJxxdNmo4v11AqCoQpq','W7jLha','yg9mwdS','WO3cHIr4WPBdRmoYuY7cJMVdPfRdTW','57MM5y618yYNRq','x8o3W5dcUr7cU0S9t8kY','WPldU8k9rmoA','WQNdRSkBW5C9FZ5WWRpcPmkKCCkFW5NcISoMW7D9Fq','B2DW','WOuvwCkCjG','5BQc6zoC56EX5yUr8kcFUU+5UW','CSkhwmkPWRL6WOK/qGu7lCkwzq','qLKaa8oJ','WP/dK08Jxmkw','gmkjWRXnW5VdRCkBW7VdVmkHWPddHmo9nbHqxa','WRVdVSkyWRmU','oSoiWO0RaWy','WPPKqa','tSoHW5FcUa','WQFcG8oknZq','o8ogWPO','oSklnxRcHCovcCotoCk5','rSkxW5NcRCoIod/dQCoiW6X5y8kgW6DVWPJdMW','WPHVtComW54','xmkbW40zuW','E8klwmk5WRDOWOi','hw5gWR0PW6pcUSopuW','6i+f5y2f5BQn6zcT5l+E5zoD54Uc5OoU5B6E5BQAW4S','lSorWOyBoW','W5NcMqS','WOZcRWSiqG','W6RcOSkM','lSkglKdcSmoue8oCkSkvWP0','m8kVmwdcGW','WOxdUmoP','WQZcTd0fvCk0','WQZdV8oFW6L3W5lcGCk+W5i+tYyiWRrVfmkPW5a4WPClxSk4o2NcVCkr','WQFdPCkCW6eNza','WQhcQcK','h3LCWRiGW5K','iSoxA8knWQu','W7LUd8oHWQTiW7NcVCk6EwS3chmOgSkEgCkPWRjA','bL5xWPy2','WRJcJYvJWQG','Aez9cH4'],...(function(){return[...['WQ/cHmowiIxdLq','W7pcLCklW5ThW5yHs8kYWOddMmopW6HHurFdSCoqWOO','W7xcGmo8oSkyW57cRLeEW5S','zbxdGtGl','5yQX5ysi5BU76zg85l2t5zcg5OQO5yMX77626i6Y5B+E772B','W67cMmosW4THWPuRBmoVWQ3dL8oIW7OOrgpcR8kyW5W','W51+nmk+WPZdTCkzDCkjWRxcHmoqFWG','tSo1W5BcSqxcOxSLCSk3','nCoDWRiApG','zvnTWR8','pG0MpSoIW6ldGLVdP8oyW7JdJ8khCq','W6XTuxZdNa','WQddNSoi','jIBcISkSWQq','qwtcKmkXW77cSCo8','W7JcN8ky','qmkIW5W8FsunWRG','WRHYmCkzW6S','W6/cRb/dNHK','W4xcKgejWQRdM8kjn8o1WQr7z07cIJpdV8k+W6NcOhpdMK3cJ0bjWOS2W7lcHZtdM8oTW6JdSG','zsRdIW','WQ3dNSk/B8oEWPO','e8oaWOmbea','4P+yW5dOH6xMNQtOV7/OO7xPGjBLIltKUytPL7ZORzNcHG','W4dcUGxdHX/cPuG','fCodWOC','txlcKmkRW7JcUa','BYZdGHOPW501','jatcTW','W4hcHSkTW5Hl','D09WWRmQdadcHvpcG2iRe00','5RwT5yIp5AEa54cf54M377246k+256Ms5zcA5ywI6kY+','W6VcQmkYWQmxqSki','x18zbmoJ','v8keW4xcQCkM','BcVdMG','xmk8B8kJWQ3dQqFdGmooW4FcItJcImoWW4VcTG','tmoSrSkbW59gWOtcPCkRW7xdUgddVCo3WRJdLqtcTq','W6BdJhG','wcjUW68E','WPWqFSkjmq','WRzby8ocW6K','DqWyW6C','W7PUgCo2WPHkW7e','W4FcRbZdNr/cR0tcTH/cGmkoWQbnWO8','qxXCWPWB','6lEm5yYu5PAW5Pw8','q8owW79fW5ddHSkTW73dHW','WQT8m8kFW6K','EM/dVJBdV3aMg8kupSkGW6i','hmkcWRTBW4JdR8kn','zSkkW5FcJCk3','W4dcHmk1WQat','emkqBNRcVK7dGSoNW5LwxSkFWOvIWPuVEIe','WQRdLCkPBSo+WOVdUG5zWOOjW5RdKYiLW7xcLXBdV8omEG','WP9UwYPEBsa','WODNrWLD','s8ktdmobWRjYFCk+WQPXW4BdIW','WRa0hsu','W6/cQCkaWP8/','WQldPmki','BHDiW50','pdlcGeZcGa','WQ3cHmojns/dKSkzWO/cMCoLW6XQeLG','W7DZfColWQi','W6NdSuZdH8kz','nCoiWOqnjrvYna','WQpdOmkLW4Sq','WONcKtvvWO3dRG','oCosWP4OhrvM','WR3dO8kaW7q4DsnDWQBcS8kvx8kHW4hcISoWW7P0FW','W7BcUmkYWRG','W67cV8on','d8ots8khW6u','fsJcLSk3WQ0','xe5P','WPBdO8kQW5BdNG','pCouWOmmkq','nvyEWOPi','WQVcIXvqWOK','DKLWWReuaG','WQZcG8om','WPBdM1KRwG','W6tcHCkmW6a','WQ96oSkdW7vx','W7VcHCklW45dW5G2','q8kzW5SyCq','WQdcOJ0Fu8k9W5G','dCozW5ZcUsdcUNS','s14wfSoEW6TYlW'],...(function(){return['yhyjnSoI','WR0eqCkI','5Bs/5PME5lYO5zks','uCkjtmkAWQ8','zGWfW7i','v8o6W5dcTrRcT0WWDCkeChtdSvtdOmopWRC','imkuWRXPW4W','hSogcYavfKLLy8ojW6hcNKW','5BME6zcx5l6G5zco5lMn5A+/5z+FW5VXJBI6','uSo7W4m','uSkfW5/cRCkdFtBdRSolW7jBDSkrWQ8gWPtdJWC','W7RdGvFdLSk6','rCkssG','g8ozsSkzW6qS','4PI5eUIgJ+wSHUs6IoI9REIHNUMvN+MySEAwJoMxM+IVQEE9QoMwM+IUQW','qGGCW7iO','W57cHYpdUbS','WQVcGSoElW','W6r/gmoSWPDkW73cTmk1','EYddNW4PW4u','W7FcR8kIWOKL','ywrNFY4','qfiEbCoJW60','kdZcV23cScKJeCk8lW','WQJcNCokoINdHmkwWO/cO8o+W7aSbbjdotZcIvdcM8oigSk8wfCvgCkLmrdcMKuZ','44cX6lEl5y2h','w8kIWOvZEG','WPXIqc9nztRcLWa4','WOXJvX9O','W7mWpmkcW7bptKX8WPRdTSkrW6RcJhTAqCoKeSktW6hdI1S','W6hdOwFdLmkv','WPe4WQOOm8o0WOzUWOSFWQW4W7O','nUISMEAXQEwqH+w5GI8','W47cKCk4mLyvWPm','W5JcP2mTWOm','WR4XnIVcLbBcHtpdHJ7cO8olWPf0zmoYWPqrW4/dJmkhW4TsW4xdKCop','WPbYuW','WRfWlG','ESkbta','qCkuWRntASkPshu','WOtcGJ1r','WOddRSkn','WQRcJmoonsG','WQtcTa8Eqmk7W4q','W68OECogWQ0','WRGtsmkCeG','W5RcICoZW5vT','jvHCW7aaemoVWOpdVq','5l2t5zch5y6Q77YE','W5D2kCkkWRNdTCkdACkwWR7cJmoBrq','W7xcGCo5pCkyW5ZcPdLTWOyPW7VdTG','5BQE6zk/5l625zcJ5lMi5A+P5z2KW6dWKzUw','5lIp6lgE8jEHQa','WPJdPu0GEG','bCo0WOv4hq','W73cU8oAWRzSid9mWQlcTmk/rG','W4xcOLGuWQm','WOJLLPBLRjZdLfRVVQq','fstcJCkNWQddOSkaW7PdoMajW7ZdTa','uCojnMFcIMxdQSo3W7q','xW7dNtuZ','W7jRvX8M','W6lWMOQ/','4P+VooACIEIcO+ASOoEGNUwMPoErTSoq','umkMW4eahd8u','fG0LpCoK','W6pdJwVdOmkDwCkZW5ddUvpcHmoCCq','vCoRqmkF','WQaZzmkRea','WQVdL1qMxa','WR9WjSkAW7XcuW','ltBcUgFcQtu5hmkMp8kNW7/cS14','W5mUxIj4yYhcHsa5','WQVcHmoumHFdJSkdWPpcNmo0W7bNgu0','nXizdSoO','kJu0Cv93lSo7WP/cKtScrW','W4lcJHj2hmogimkWmJhcSge','eSk1WPTQW58','WQfnzCo3W7a','rw/cKmkNW63cOG','WOVcJZW','w8o5W5tcPbe','rmkKkSoVW7dcTKhcN8oiW63cGrZcIW','EXLfW5aSk8oIWQC','WOOwvCkAjG','W4HRW6biA8kVW58JW7q','iX8Li8oxW6BdHHa','W5NWQyMY','W5vZbCk1WRVdUCkdFSk+WQlcJSoRFbxdTGRdVSkRWR7cOe1RWQ5nW5SFW49EW5pcQs9ppNm'];}())];}())];}());Iii11l=function(){return iii1lI;};return Iii11l();};!(async()=>{const iIIiii=Ilil1l,i1i1Ii={'kBxQz':function(lllii,iI11Ii){return lllii(iI11Ii);},'YoOeu':function(iIII1l){return iIII1l();},'GggPy':function(lllil,iI11Il){return lllil!==iI11Il;},'tZnPX':iIIiii(0x255,'hdeP'),'QEiCW':'⚠\x20自定义运行间隔时长设置错误','yligU':iIIiii(0x1a2,'jWnL'),'emxor':function(iIII1i,iil1i1){return iIII1i>iil1i1;},'PDqZa':function(il1i11,IlIll1){return il1i11===IlIll1;},'nnpat':function(IlIII,ilil1l){return IlIII===ilil1l;},'VshZe':iIIiii(0x28d,'rYSG'),'mkJOE':iIIiii(0x240,'CoFH'),'mWThS':iIIiii(0x224,'LD$s'),'HdkVy':function(illlIi,I1lIii){return illlIi===I1lIii;},'ehSup':iIIiii(0x1c3,'@Y@S')};try{if(i1i1Ii[iIIiii(0x24a,'NOnB')](i1i1Ii['tZnPX'],i1i1Ii[iIIiii(0x26d,'hIlL')])){const illlIl=iIli1I['shift']();Iiil1++,iiilli[iIIiii(0x25e,'AEQI')](i1i1Ii[iIIiii(0x214,'[pmF')](l1iIIl,illlIl));}else{notify[iIIiii(0x267,'(H6x')]({'title':$[iIIiii(0x299,'EZDD')]});if(idList[iIIiii(0x287,'D7Bh')]>0x0)idList=[...new Set(idList[iIIiii(0x217,'WL6G')](i11ill=>i11ill!==''))];if(idList[iIIiii(0x1f7,'#d*m')]<=0x0){console[iIIiii(0x1d0,'WBZB')]('⚠\x20请先定义必要的环境变量后再运行脚本！');return;}$[iIIiii(0x227,'hIlL')]=null;if(runInterval)try{const IIIIIi=i1i1Ii[iIIiii(0x28f,'(7Dc')](parseInt,runInterval);IIIIIi>=0x0&&($[iIIiii(0x1bc,'QaLO')]=IIIIIi);}catch{console[iIIiii(0x23d,'(7Dc')](i1i1Ii[iIIiii(0x286,'81Bk')]);}try{if(iIIiii(0x1f0,'&[*d')===i1i1Ii[iIIiii(0x1c5,'zK*d')]){const IIIIIl=i1i1Ii['kBxQz'](parseInt,taskThreads);i1i1Ii[iIIiii(0x269,'#d*m')](IIIIIl,0x0)&&i1i1Ii['GggPy'](IIIIIl,0x1)&&(taskThreads=IIIIIl);}else lilil[iIIiii(0x20d,'2Hh#')](ll1ll,Illl11);}catch{i1i1Ii[iIIiii(0x212,'@Y@S')](iIIiii(0x229,'zK*d'),iIIiii(0x1a7,'QaLO'))?taskThreads=0x1:I1i11I['log'](llIliI+'加入店铺会员成功');}try{if(i1i1Ii[iIIiii(0x1fd,'WL6G')](iIIiii(0x264,'^V3]'),'ksibX')){const liiII1=i1i1Ii[iIIiii(0x202,'hIlL')](parseInt,accountThreads);i1i1Ii[iIIiii(0x228,')CCk')](liiII1,0x0)&&i1i1Ii[iIIiii(0x274,'H9wX')](liiII1,0x1)&&(i1i1Ii[iIIiii(0x1f6,'D7Bh')](i1i1Ii[iIIiii(0x1c8,'QaLO')],iIIiii(0x285,'AEQI'))?accountThreads=liiII1:iliIII=iIIl1i);}else i1l1li=0x1;}catch{if(i1i1Ii[iIIiii(0x1ba,'Y!RV')](iIIiii(0x1b0,'QaLO'),i1i1Ii[iIIiii(0x25a,'Cy[b')]))accountThreads=0x1;else{l1lIl1[iIIiii(0x22b,'jWnL')](IiiIlI+iIIiii(0x279,'WL6G')),Iilli1[iIIiii(0x1f2,'4XJ8')](I1l1Il,!![]);return;}}$[iIIiii(0x1db,'LD$s')]=[],$[iIIiii(0x20a,'b5C]')]=![];idList['length']>0x1&&(iIIiii(0x22d,'^V3]')===i1i1Ii['mWThS']?$['showPrintId']=!![]:ill111=0x1);await common[iIIiii(0x259,'^V3]')](accountThreads,cookiesArr,async(lllli,iiili1)=>{const iilll=iIIiii;await concMain(taskThreads,idList,lllli,iiili1,Main);if($['waitTime'])await $[iilll(0x275,'bHeQ')]($[iilll(0x1e6,'(7Dc')]);});if(isNotify&&notify[iIIiii(0x1ff,'b5C]')]()){if(i1i1Ii[iIIiii(0x1f3,'Y!RV')](i1i1Ii[iIIiii(0x263,'qSSh')],i1i1Ii[iIIiii(0x1e2,'2Hh#')]))await notify['push']();else{const lllill=lIII1l(()=>{const il1iI1=iIIiii;lilIl===0x0&&(i1i1Ii[il1iI1(0x1da,'3TRl')](Iiiil,lllill),i1i1Ii[il1iI1(0x1c9,'81Bk')](Iiiii));},0x64);}}}}catch(ill11l){console['log'](iIIiii(0x22e,'kHf*')+ill11l);}})()[Ilil1l(0x29b,'WL6G')](I1lIiI=>$[Ilil1l(0x1fa,'^V3]')](I1lIiI))[Ilil1l(0x232,'jWnL')](()=>$['done']());async function Main(lllili,IliiiI){const IlllIi=Ilil1l,Ill11={'SrBbZ':IlllIi(0x23f,'Y!RV'),'QstAe':IlllIi(0x218,'kHf*'),'ZzYCG':function(lil111,i11ilI){return lil111===i11ilI;},'mPmCN':IlllIi(0x1b3,'8u])'),'xhPVN':function(ii1ii1,llllI){return ii1ii1===llllI;},'nApWc':function(lllil1,iil1il){return lllil1===iil1il;},'cXqxi':function(ilil1I,i11il1){return ilil1I!==i11il1;},'Septa':IlllIi(0x1aa,'Y!RV'),'sXULe':function(ii1iiI,lllilI){return ii1iiI===lllilI;},'uCTcM':'加入店铺会员成功','InJcq':'AqSue','AhEdp':function(ilil11,illlI1){return ilil11===illlI1;},'EhKuL':IlllIi(0x234,'kHf*'),'vkylP':'tWBdU','viuth':IlllIi(0x19e,'3ytk'),'cKdoM':IlllIi(0x25d,'Cy[b'),'KXqKj':IlllIi(0x265,'3TRl'),'TZBKf':IlllIi(0x19c,'hIlL'),'gYNrg':IlllIi(0x21d,'uOM5'),'MthNm':IlllIi(0x1e8,'3TRl'),'wDuKX':IlllIi(0x1bb,'E)e('),'FItpe':IlllIi(0x21c,'kHf*'),'idAOI':'cors','qmiOh':IlllIi(0x289,'WL6G'),'VFKiC':function(IIIl11,I1lIi1){return IIIl11<I1lIi1;},'Xaubt':IlllIi(0x206,'^V3]'),'tDyCu':IlllIi(0x1c2,'QaLO'),'nQWbE':IlllIi(0x215,'EZDD'),'OuPtb':function(liiIIi,lil11I,Iliii1){return liiIIi(lil11I,Iliii1);},'YCSwE':function(iIiIi,iil1ll){return iIiIi>=iil1ll;}},{title:liiIII,UA:li1i11,cookie:iI11I1,message:il1i1l}=IliiiI;if(invalidIdsMap[IlllIi(0x20c,'yq4Y')](lllili))return;let IlIlll='',IIIl1I=undefined,iil1ii=[];await il1i1i(Ill11[IlllIi(0x1a3,'bMBg')]);if(invalidIdsMap[IlllIi(0x1fb,'rYSG')](lllili))return;if(typeof IIIl1I===IlllIi(0x24e,'rYSG')){if(IIIl1I)console[IlllIi(0x210,'2Hh#')](liiIII+'已是会员');else{if(invalidIdsMap['get'](lllili))return;await il1i1i(IlllIi(0x1af,'WL6G'));}}async function IlIlli(iiilil,iil1li){const iIIiil=IlllIi,lillIl={'KjAud':function(iIiIl,iiilii){return iIiIl(iiilii);}};try{if(iIIiil(0x29e,'Y!RV')!==Ill11[iIIiil(0x1c7,'b5C]')])switch(iiilil){case Ill11[iIIiil(0x277,'8u])')]:if(Ill11[iIIiil(0x201,'CoFH')](iil1li['success'],!![])){let li1i1i=iil1li['result'];Array[iIIiil(0x29c,'2Hh#')](li1i1i)&&(iIIiil(0x258,'(7Dc')!==Ill11[iIIiil(0x21a,'jWnL')]?IIli1i['log'](''+I1iIi1+lliil1[iIIiil(0x237,'AEQI')]+'\x20🚫'):li1i1i=li1i1i[0x0]);IIIl1I=Ill11['xhPVN'](li1i1i?.[iIIiil(0x1e7,'qSSh')]?.['openCardStatus'],0x1),IlIlll=li1i1i?.[iIIiil(0x1f8,'8u])')]?.[0x0]?.[iIIiil(0x1a8,'(7Dc')]?.[iIIiil(0x28c,'rYSG')];const {venderCardName:IlIli1,venderCardLogo:illIiI}=li1i1i?.['shopMemberCardInfo'];if(li1i1i?.[iIIiil(0x27b,'NOnB')]&&!IlIli1&&!illIiI){console[iIIiil(0x1c0,'(add')](liiIII+'店铺会员不存在\x20🚫'),invalidIdsMap['set'](lllili,!![]);return;}!$[iIIiil(0x290,'E)e(')+lllili]&&($[iIIiil(0x2a2,'uOM5')+lllili]=!![],console[iIIiil(0x253,'Cy[b')](iIIiil(0x19f,'^[&]')+lllili),console['log']('会员卡：'+(li1i1i?.[iIIiil(0x24c,'6XtD')]?.[iIIiil(0x1a0,'LD$s')]||'未知')+'\x0a'));}else iil1li[iIIiil(0x1d4,'WBZB')]?console[iIIiil(0x262,'81Bk')](''+liiIII+iil1li[iIIiil(0x26e,'2Hh#')]):console[iIIiil(0x1d8,'@Y@S')](liiIII+iIIiil(0x205,'@Y@S')+JSON[iIIiil(0x283,'a^6&')](iil1li)+'\x20🚫');break;case iIIiil(0x235,'(H6x'):if(Ill11[iIIiil(0x20b,'b5C]')](iil1li['success'],!![])){if(Ill11[iIIiil(0x1b4,'CoFH')](Ill11['Septa'],Ill11[iIIiil(0x280,'bHeQ')]))lillIl['KjAud'](l11i1i,lI11I1),l1il11();else{if(Ill11[iIIiil(0x28b,'2ef]')](iil1li[iIIiil(0x249,'8u])')],Ill11['uCTcM'])){if(iil1li[iIIiil(0x284,'jWnL')]&&iil1li['result']?.['giftInfo']){iil1ii=[];for(const llI1Il of iil1li[iIIiil(0x26b,')CCk')]?.[iIIiil(0x270,'D7Bh')]?.['giftList']){if(Ill11['InJcq']==='uIGzc')IlI1l=lilIil;else{const {prizeType:i11iil}=llI1Il;switch(i11iil){case 0x1:case 0x17:iil1ii[iIIiil(0x272,'Y!RV')]('优惠券🗑️'),il1i1l[iIIiil(0x22c,'&[*d')]('优惠券🗑️');break;case 0x4:iil1ii[iIIiil(0x26a,'kHf*')](llI1Il[iIIiil(0x1ad,'hdeP')]+iIIiil(0x2a5,'bMBg')),il1i1l[iIIiil(0x20f,'Cy[b')](llI1Il[iIIiil(0x1e1,'a^6&')]+'京豆🐶');break;case 0x6:iil1ii['push'](llI1Il['discountString']+iIIiil(0x1f4,'(H6x')),il1i1l[iIIiil(0x1df,'rYSG')](llI1Il['discountString']+'店铺积分🎟️');break;case 0xe:iil1ii[iIIiil(0x220,'(H6x')](llI1Il['discountString']+'红包🧧'),il1i1l['insert'](llI1Il['discountString']+iIIiil(0x1ee,'&[*d'));break;default:iil1ii['push'](''+llI1Il[iIIiil(0x256,'WL6G')]+llI1Il[iIIiil(0x204,'[pmF')]),il1i1l[iIIiil(0x1b5,'*BRY')](''+llI1Il[iIIiil(0x1f5,'H9wX')]+llI1Il['prizeName']);}}}console[iIIiil(0x1d6,'2ef]')](liiIII+iIIiil(0x21b,'bHeQ')+iil1ii[iIIiil(0x1a9,'WBZB')]('、'));}else Ill11[iIIiil(0x266,'EZDD')](Ill11['EhKuL'],iIIiil(0x293,'3ytk'))?IIli11[iIIiil(0x254,'3TRl')]['activityId']=IllIII:console['log'](liiIII+'加入店铺会员成功');}else Ill11[iIIiil(0x208,'2Hh#')](iil1li['message'],iIIiil(0x236,'^V3]'))?Ill11[iIIiil(0x257,'(add')](Ill11['vkylP'],'hRtox')?(lilIl1[iIIiil(0x295,'rYSG')](i1l1ii['name'],'【提示】请先获取Cookie'),i1l1['exit'](0x1)):console[iIIiil(0x297,'H9wX')](''+liiIII+iil1li['message']+iIIiil(0x1a4,'CoFH')):console[iIIiil(0x25f,'^[&]')](''+liiIII+iil1li[iIIiil(0x22f,'zK*d')]+'\x20🚫');}}else{if(iil1li[iIIiil(0x242,'a^6&')]){if(Ill11[iIIiil(0x239,'NOnB')]===Ill11[iIIiil(0x261,'LD$s')])console[iIIiil(0x27a,'62&y')](''+liiIII+iil1li[iIIiil(0x225,'*BRY')]+iIIiil(0x1bd,'E)e('));else try{const i11iii=II1Il(lilIlI);i11iii>=0x0&&(iii1I1[iIIiil(0x1b9,'3TRl')]=i11iii);}catch{i1ii['log'](iIIiil(0x27f,'(add'));}}else console['log'](liiIII+'加入店铺会员失败\x20🚫');}break;}else liIiI===0x0&&(li1(illIl1),l1llII());}catch(lllI1i){console[iIIiil(0x1de,'zK*d')]('❌\x20未能正确处理\x20'+iiilil+iIIiil(0x1ce,'3ytk')+(lllI1i[iIIiil(0x203,'H9wX')]||lllI1i));}}async function il1i1i(li1i1l){const i1l1Ii=IlllIi;let II1i1=i1l1Ii(0x22a,'3ytk'),lI1lll=null,iIiII=null,iil1lI='POST',iiiliI={},li1i1I={};switch(li1i1l){case'getShopOpenCardInfo':li1i1I={'appId':i1l1Ii(0x29d,')CCk'),'appid':Ill11['cKdoM'],'functionId':i1l1Ii(0x1f1,'Cy[b'),'clientVersion':Ill11[i1l1Ii(0x1d9,'@Y@S')],'client':'H5','body':{'venderId':lllili,'payUpShop':!![],'queryVersion':'10.5.2','appid':Ill11[i1l1Ii(0x23e,'3TRl')],'needSecurity':!![],'bizId':Ill11[i1l1Ii(0x1cc,'a^6&')],'channel':0x196},'version':i1l1Ii(0x223,'kHf*'),'t':!![],'ua':li1i11},iiiliI=await H5st['getH5st'](li1i1I),lI1lll=iiiliI[i1l1Ii(0x21e,'62&y')];break;case Ill11['gYNrg']:li1i1I={'appId':Ill11[i1l1Ii(0x244,'(H6x')],'appid':'shopmember_m_jd_com','functionId':Ill11['gYNrg'],'clientVersion':i1l1Ii(0x1f9,'^[&]'),'client':'H5','body':{'venderId':lllili,'bindByVerifyCodeFlag':0x1,'registerExtend':{},'writeChildFlag':0x0,'channel':0x196,'appid':i1l1Ii(0x1dd,'E)e('),'needSecurity':!![],'bizId':Ill11[i1l1Ii(0x1cc,'a^6&')]},'version':i1l1Ii(0x230,'NOnB'),'t':!![],'ua':li1i11};IlIlll&&(i1l1Ii(0x24f,'rYSG')===Ill11['MthNm']?li1Il[i1l1Ii(0x253,'Cy[b')](li1Ii+i1l1Ii(0x273,'Y!RV')):li1i1I[i1l1Ii(0x282,'WL6G')][i1l1Ii(0x288,'hdeP')]=IlIlll);iiiliI=await H5st[i1l1Ii(0x1a6,'hIlL')](li1i1I),lI1lll=iiiliI['paramsData'];break;}const illIii={'area':'','screen':Ill11[i1l1Ii(0x1dc,'QaLO')],'uuid':i1l1Ii(0x222,'2MH1')};lI1lll&&Object[i1l1Ii(0x1cd,'hIlL')](lI1lll,illIii);iIiII&&Object[i1l1Ii(0x231,'*BRY')](iIiII,illIii);const ii1il1={'url':II1i1,'method':iil1lI,'headers':{'Accept':i1l1Ii(0x207,'#d*m'),'Accept-Encoding':i1l1Ii(0x200,'NOnB'),'Accept-Language':Ill11[i1l1Ii(0x24b,'AEQI')],'Origin':'https://pages.jd.com','Referer':i1l1Ii(0x1ea,'NTUw'),'Sec-Fetch-Dest':i1l1Ii(0x1b7,'62&y'),'Sec-Fetch-Mode':Ill11[i1l1Ii(0x252,'AEQI')],'Content-Type':Ill11[i1l1Ii(0x1d3,'kHf*')],'User-Agent':li1i11,'Cookie':iI11I1},'params':iIiII,'data':lI1lll,'timeout':0x7530};Ill11[i1l1Ii(0x1d2,'2Hh#')](iil1lI,i1l1Ii(0x233,'LD$s'))&&(delete ii1il1[i1l1Ii(0x241,'bHeQ')],delete ii1il1['headers']['Content-Type']);const lI1llI=0x1;let illIil=0x0,Ill1I=null,i11iiI=![];while(Ill11['VFKiC'](illIil,lI1llI)){if(Ill11[i1l1Ii(0x1ab,'#d*m')]===Ill11[i1l1Ii(0x216,'4XJ8')])ii1ll['log'](i1l1Ii(0x1a5,'bMBg')+IliI1l+i1l1Ii(0x291,'H9wX')+(lliiil['message']||lliiii));else{const lillI1=await common['request'](ii1il1);if(!lillI1['success']){if(Ill11[i1l1Ii(0x281,'zK*d')](i1l1Ii(0x260,'eBCr'),Ill11['nQWbE'])){let i1l1i1=Iliill[i1l1Ii(0x211,'[pmF')];IIII11['isArray'](i1l1i1)&&(i1l1i1=i1l1i1[0x0]);i1illi=i1l1i1?.['userInfo']?.[i1l1Ii(0x1c4,'(H6x')]===0x1,i1illl=i1l1i1?.[i1l1Ii(0x276,'62&y')]?.[0x0]?.['interestsInfo']?.[i1l1Ii(0x1ef,'62&y')];const {venderCardName:liil11,venderCardLogo:iiillI}=i1l1i1?.[i1l1Ii(0x23c,'WBZB')];if(i1l1i1?.['shopMemberCardInfo']&&!liil11&&!iiillI){lI1Ili['log'](IliilI+i1l1Ii(0x2a4,'jWnL')),i1II1[i1l1Ii(0x29a,'qSSh')](iIIl11,!![]);return;}!iliII1['hasPrintInfo_'+II11I1]&&(l1l1I1[i1l1Ii(0x1c6,'D7Bh')+I1iIll]=!![],I1lliI[i1l1Ii(0x296,')CCk')]('\x0a商家ID：'+llIllI),I1ilI1['log'](i1l1Ii(0x2a1,'hdeP')+(i1l1i1?.['shopMemberCardInfo']?.['venderCardName']||'未知')+'\x0a'));}else{Ill1I=liiIII+'请求失败（'+lillI1['error']+'）🚫',illIil++;continue;}}if(!lillI1[i1l1Ii(0x251,'2MH1')]){Ill1I=liiIII+'请求失败（无响应数据）🚫',illIil++;continue;}await Ill11['OuPtb'](IlIlli,li1i1l,lillI1['data']),i11iiI=![];break;}}Ill11['YCSwE'](illIil,lI1llI)&&(console[i1l1Ii(0x209,'AEQI')](Ill1I),i11iiI&&($[i1l1Ii(0x25c,'^V3]')]=!![]));}}async function concMain(l1l111=0x1,l1iIII,llI1I1,IlIlil,lIli1I){const I1iIIi=Ilil1l,II1il={'JEqya':function(l1iII1,iiill1){return l1iII1!==iiill1;},'kSldR':function(lIli1i,IIIII1){return lIli1i<IIIII1;},'KQgYS':function(I1lIlI,ii1ill){return I1lIlI(ii1ill);},'XYYHs':function(II1iI,llI1II){return II1iI(llI1II);},'RwFPq':function(lIli1l){return lIli1l();},'LAyTu':I1iIIi(0x247,')CCk'),'pbHSU':'账号无效','uEsJb':function(lillIi){return lillIi();}};if($[I1iIIi(0x213,'a^6&')][I1iIIi(0x298,'2ef]')](IlIlil))return;const lllI11=l1iIII[I1iIIi(0x27d,'NTUw')](illIi1=>illIi1),I1lIll=decodeURIComponent(common['getCookieValue'](llI1I1,'pt_pin')),I1lIli=I1iIIi(0x28a,'NOnB')+IlIlil+'】'+I1lIll+'：'+($['showPrintId']?venderId+'\x20➜\x20':''),II1ii=notify[I1iIIi(0x25b,'EZDD')](IlIlil,I1lIll),IIIIII=await common[I1iIIi(0x1ed,'EZDD')](llI1I1);if(!IIIIII&&typeof IIIIII===I1iIIi(0x1ac,')CCk')){if(II1il[I1iIIi(0x271,'D7Bh')]===I1iIIi(0x21f,'^V3]'))Iiii1[I1iIIi(0x226,'kHf*')](lIIili),IiiIil&&(IIlll[I1iIIi(0x26c,'kHf*')]=!![]);else{console['log'](I1lIli+I1iIIi(0x245,'EZDD')),II1ii['fix'](II1il[I1iIIi(0x27c,'(7Dc')]),$[I1iIIi(0x24d,'&[*d')][I1iIIi(0x1fc,'62&y')](IlIlil);return;}}const lillII=common['genUA'](I1lIll),ii1ilI={'cookie':llI1I1,'index':IlIlil,'title':I1lIli,'UA':lillII,'message':II1ii};let lI1ll1=0x0;async function iIiI1(liil1i){const I1iIIl=I1iIIi;II1il[I1iIIl(0x1cb,'(add')](I1iIIl(0x1ec,'81Bk'),'NazAs')?(await lIli1I(liil1i,ii1ilI),lI1ll1--,liil1I()):IiiIiI[I1iIIl(0x27e,'eBCr')](lilii,l1iiI);}async function liil1I(){const lI1IIl=I1iIIi;while(II1il[lI1IIl(0x19b,'#d*m')](lI1ll1,l1l111)&&lllI11[lI1IIl(0x1d1,'qSSh')]>0x0){const i1l1iI=lllI11[lI1IIl(0x238,'D7Bh')]();lI1ll1++,await II1il[lI1IIl(0x1e4,'3ytk')](iIiI1,i1l1iI);}}const i11ii1=Math['min'](lllI11[I1iIIi(0x1cf,'b5C]')],l1l111),IlIliI=[];for(let liil1l=0x0;liil1l<i11ii1;liil1l++){const lI1lii=lllI11['shift']();lI1ll1++,IlIliI['push'](iIiI1(lI1lii));}await Promise[I1iIIi(0x1b6,'EZDD')](IlIliI),II1il['uEsJb'](liil1I),await new Promise(Iiili1=>{const Iil1l1=setInterval(()=>{const i1ilI=iii1II;lI1ll1===0x0&&(II1il[i1ilI(0x29f,'^[&]')](clearInterval,Iil1l1),II1il['RwFPq'](Iiili1));},0x64);});}var version_ = 'jsjiami.com.v7';
// prettier-ignore
function Env(t,e){"undefined"!=typeof process&&JSON.stringify(process.env).indexOf("GITHUB")>-1&&process.exit(0);class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),n={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(n,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.post(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method="POST",this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:s,...i}=t;this.got.post(s,i).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`❗️${this.name}, 错误!`,t.stack):this.log("",`❗️${this.name}, 错误!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
