/*
ÂΩìÊó•Êî∂ÊîØÊü•ËØ¢
ÁéØÂ¢ÉÂèòÈáèÔºöjd_querryBeans_notify // ÊòØÂê¶Êé®ÈÄÅÈÄöÁü•Ôºàtrue/falseÔºâÔºåÈªòËÆ§‰∏çÊé®ÈÄÅ

cron:1 1 1 1 *

*/

const $ = new Env('ÂΩìÊó•Êî∂ÊîØÊü•ËØ¢')
function _0x39f6(_0x1229da,_0x33fdb4){const _0x5084e5=_0x5084();return _0x39f6=function(_0x39f662,_0x511518){_0x39f662=_0x39f662-0x133;let _0x595bc9=_0x5084e5[_0x39f662];if(_0x39f6['sJPBBE']===undefined){var _0x168cc2=function(_0x14ef5a){const _0xa3c59='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0xc5f25d='',_0x20213d='';for(let _0x424ce6=0x0,_0x2fbd66,_0x17ee6b,_0x5882a3=0x0;_0x17ee6b=_0x14ef5a['charAt'](_0x5882a3++);~_0x17ee6b&&(_0x2fbd66=_0x424ce6%0x4?_0x2fbd66*0x40+_0x17ee6b:_0x17ee6b,_0x424ce6++%0x4)?_0xc5f25d+=String['fromCharCode'](0xff&_0x2fbd66>>(-0x2*_0x424ce6&0x6)):0x0){_0x17ee6b=_0xa3c59['indexOf'](_0x17ee6b);}for(let _0x355c5d=0x0,_0x1196d6=_0xc5f25d['length'];_0x355c5d<_0x1196d6;_0x355c5d++){_0x20213d+='%'+('00'+_0xc5f25d['charCodeAt'](_0x355c5d)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x20213d);};const _0x3efc2d=function(_0x55ac6b,_0x149d28){let _0x1b825b=[],_0x9dce24=0x0,_0x55ed25,_0x21a2a9='';_0x55ac6b=_0x168cc2(_0x55ac6b);let _0x57d641;for(_0x57d641=0x0;_0x57d641<0x100;_0x57d641++){_0x1b825b[_0x57d641]=_0x57d641;}for(_0x57d641=0x0;_0x57d641<0x100;_0x57d641++){_0x9dce24=(_0x9dce24+_0x1b825b[_0x57d641]+_0x149d28['charCodeAt'](_0x57d641%_0x149d28['length']))%0x100,_0x55ed25=_0x1b825b[_0x57d641],_0x1b825b[_0x57d641]=_0x1b825b[_0x9dce24],_0x1b825b[_0x9dce24]=_0x55ed25;}_0x57d641=0x0,_0x9dce24=0x0;for(let _0x53eb5a=0x0;_0x53eb5a<_0x55ac6b['length'];_0x53eb5a++){_0x57d641=(_0x57d641+0x1)%0x100,_0x9dce24=(_0x9dce24+_0x1b825b[_0x57d641])%0x100,_0x55ed25=_0x1b825b[_0x57d641],_0x1b825b[_0x57d641]=_0x1b825b[_0x9dce24],_0x1b825b[_0x9dce24]=_0x55ed25,_0x21a2a9+=String['fromCharCode'](_0x55ac6b['charCodeAt'](_0x53eb5a)^_0x1b825b[(_0x1b825b[_0x57d641]+_0x1b825b[_0x9dce24])%0x100]);}return _0x21a2a9;};_0x39f6['LcFAoU']=_0x3efc2d,_0x1229da=arguments,_0x39f6['sJPBBE']=!![];}const _0x7704e=_0x5084e5[0x0],_0x325a39=_0x39f662+_0x7704e,_0x42afc2=_0x1229da[_0x325a39];return!_0x42afc2?(_0x39f6['TZUEqG']===undefined&&(_0x39f6['TZUEqG']=!![]),_0x595bc9=_0x39f6['LcFAoU'](_0x595bc9,_0x511518),_0x1229da[_0x325a39]=_0x595bc9):_0x595bc9=_0x42afc2,_0x595bc9;},_0x39f6(_0x1229da,_0x33fdb4);}const _0x5a268b=_0x39f6;(function(_0xb5b58,_0x46b004){const _0x3d7959=_0x39f6,_0x354351=_0xb5b58();while(!![]){try{const _0xdd454c=-parseInt(_0x3d7959(0x139,'RYYG'))/0x1*(parseInt(_0x3d7959(0x181,'Owh4'))/0x2)+-parseInt(_0x3d7959(0x165,'YKKE'))/0x3*(-parseInt(_0x3d7959(0x13b,'eLK7'))/0x4)+-parseInt(_0x3d7959(0x167,'rUsp'))/0x5+parseInt(_0x3d7959(0x16d,'qgG7'))/0x6+parseInt(_0x3d7959(0x15c,'eS#P'))/0x7+-parseInt(_0x3d7959(0x192,'Sd0J'))/0x8*(-parseInt(_0x3d7959(0x18f,'sdj*'))/0x9)+-parseInt(_0x3d7959(0x16a,'sDXY'))/0xa*(parseInt(_0x3d7959(0x137,'Wkuu'))/0xb);if(_0xdd454c===_0x46b004)break;else _0x354351['push'](_0x354351['shift']());}catch(_0x1abefd){_0x354351['push'](_0x354351['shift']());}}}(_0x5084,0x7fe58));const jdCookie=require(_0x5a268b(0x1b4,'D1E5')),notify=require(_0x5a268b(0x191,'5$7p')),common=require('./utils/Rebels_jdCommon'),isNotify=process[_0x5a268b(0x136,'rUsp')][_0x5a268b(0x18b,'s(E8')]==='true',todayString=$[_0x5a268b(0x157,'eF@Z')]('yyyy-MM-dd',Date[_0x5a268b(0x141,'Owh4')]());let cookie='';const cookiesArr=Object[_0x5a268b(0x13c,'6)RL')](jdCookie)['map'](_0x3efc2d=>jdCookie[_0x3efc2d])[_0x5a268b(0x142,'l]0D')](_0x14ef5a=>_0x14ef5a);!cookiesArr[0x0]&&($['msg']($[_0x5a268b(0x14f,'YKKE')],_0x5a268b(0x171,'sDXY')),process[_0x5a268b(0x175,'#%4!')](0x1));!(async()=>{const _0x4312f1=_0x5a268b;$[_0x4312f1(0x151,'u3Z^')]=[],notify[_0x4312f1(0x194,'D1E5')]({'title':$[_0x4312f1(0x197,'rUsp')]});for(let _0xc5f25d=0x0;_0xc5f25d<cookiesArr[_0x4312f1(0x180,'5$7p')];_0xc5f25d++){$['index']=_0xc5f25d+0x1,cookie=cookiesArr[_0xc5f25d],common[_0x4312f1(0x15d,'YKKE')](cookie),$['UserName']=decodeURIComponent(common[_0x4312f1(0x18c,'(x6y')](cookie,_0x4312f1(0x187,'k)oq'))),$['UA']=common[_0x4312f1(0x186,'1]Kr')]($['UserName']),$['message']=notify[_0x4312f1(0x138,'Pdeo')]($[_0x4312f1(0x162,'#%4!')],$[_0x4312f1(0x1b1,'RYYG')]),$['nickName']='',console[_0x4312f1(0x14b,'$fw9')]('\x0a******ÂºÄÂßã„Äê‰∫¨‰∏úË¥¶Âè∑'+$[_0x4312f1(0x160,'5$7p')]+'„Äë'+($[_0x4312f1(0x13f,'u3Z^')]||$[_0x4312f1(0x1b2,'lDMJ')])+_0x4312f1(0x16f,'IezD')),$[_0x4312f1(0x16c,'YKKE')]=common[_0x4312f1(0x198,'D1E5')]($['UserName']),$['JEH']=common[_0x4312f1(0x172,'F#Y7')](),await Main(),common[_0x4312f1(0x15f,'(x6y')]();if($[_0x4312f1(0x183,'8JZU')])break;await $['wait'](0x3e8);}const _0xa3c59=notify[_0x4312f1(0x1ae,'xuI#')]();_0xa3c59&&(console['log']('\x0aüì£\x20ËøêË°åÁªìÊûú\x0a'+_0xa3c59['replace'](/Ôºö/,_0x4312f1(0x19d,'IZ9Y'))),isNotify&&await notify[_0x4312f1(0x16b,'8JZU')]());})()[_0x5a268b(0x144,'BjFf')](_0x20213d=>$['logErr'](_0x20213d))['finally'](()=>$['done']());async function Main(){const _0x2fe31d=_0x5a268b;try{$[_0x2fe31d(0x146,'eF@Z')]=![];const _0x424ce6=await common[_0x2fe31d(0x148,'D1E5')](cookie);if(!_0x424ce6&&typeof _0x424ce6==='boolean'){console[_0x2fe31d(0x1a4,'Wkuu')](_0x2fe31d(0x14e,'lDMJ'));return;}let _0x2fbd66=new Map();_0x1b2406:for(let _0x55ac6b=0x1;_0x55ac6b<=0x14;_0x55ac6b++){$[_0x2fe31d(0x149,'K%9y')]=''+_0x55ac6b,$['detailList']=[],await sendRequest(_0x2fe31d(0x1b3,'%NuK'));const _0x149d28=$[_0x2fe31d(0x199,'q*Wk')];if(_0x149d28['length']===0x0)break;for(let _0x1b825b of _0x149d28){let _0x9dce24=_0x1b825b['date'][_0x2fe31d(0x1a0,'q*Wk')]('\x20')[0x0];if(_0x9dce24===todayString)_0x1b825b['amount']=parseInt(_0x1b825b['amount']),_0x2fbd66[_0x1b825b[_0x2fe31d(0x133,'F#Y7')]]?(_0x2fbd66[_0x1b825b[_0x2fe31d(0x188,'6)RL')]][_0x2fe31d(0x145,'@MbU')]+=_0x1b825b[_0x2fe31d(0x13d,'F#Y7')],new Date(_0x2fbd66[_0x1b825b[_0x2fe31d(0x189,'1]Kr')]][_0x2fe31d(0x164,'sdj*')])<new Date(_0x1b825b['date'])&&(_0x2fbd66[_0x1b825b[_0x2fe31d(0x133,'F#Y7')]]['date']=_0x1b825b['date'])):_0x2fbd66[_0x1b825b[_0x2fe31d(0x179,'K%9y')]]={..._0x1b825b};else break _0x1b2406;}$[_0x2fe31d(0x18d,'sdj*')](0x3e8);}const _0x17ee6b=Object[_0x2fe31d(0x17e,'Pdeo')](_0x2fbd66);let _0x5882a3=0x0,_0x355c5d=0x0,_0x1196d6=[];if(_0x17ee6b[_0x2fe31d(0x13a,'l]0D')]>0x0){for(const _0x21a2a9 of _0x17ee6b){let {date:_0x57d641,amount:_0x53eb5a,eventMassage:_0x3dbcf2}=_0x21a2a9;_0x53eb5a>0x0?_0x5882a3+=_0x53eb5a:_0x355c5d+=_0x53eb5a,_0x3dbcf2=_0x3dbcf2['replace'](/ÔºàÂïÜÂìÅ:.*Ôºâ/g,'')[_0x2fe31d(0x134,'[KWG')](/ËÆ¢Âçï.*‰ΩøÁî®‰∫¨Ë±Ü.*‰∏™/g,_0x2fe31d(0x153,'u3Z^')),/ÂèÇÂä†\[.*\].*-Â•ñÂä±/[_0x2fe31d(0x163,'jZ0N')](_0x3dbcf2)&&(_0x3dbcf2=_0x3dbcf2[_0x2fe31d(0x1a2,'s(E8')](/ÂèÇÂä†\[/g,'')['replace'](/\].*/g,'')),_0x57d641=_0x57d641[_0x2fe31d(0x1a9,'[KWG')]('\x20')[0x1],_0x1196d6[_0x2fe31d(0x17a,'Wkuu')]({'Êó∂Èó¥':_0x57d641,'Ê∏†ÈÅì':_0x3dbcf2,'ÊòéÁªÜ':_0x53eb5a});}console[_0x2fe31d(0x1ad,'6)RL')](_0x1196d6);const _0x55ed25=_0x5882a3+_0x355c5d;console['log']('‰ªäÊó•Êî∂ÂÖ•\x20'+_0x5882a3+'\x20‰∫¨Ë±Ü\x20üê∂\x20‰ªäÊó•ÊîØÂá∫Ôºö'+_0x355c5d+_0x2fe31d(0x13e,'bjVU')),$[_0x2fe31d(0x150,'jZ0N')][_0x2fe31d(0x158,'F#Y7')](_0x2fe31d(0x14a,'sDXY')+_0x5882a3+'‰∫¨Ë±Ü\x20üê∂'),$[_0x2fe31d(0x193,'XPjk')]['insert'](_0x2fe31d(0x15e,'RYYG')+_0x355c5d+_0x2fe31d(0x1a3,'RYYG'));}else!$['querryError']&&console['log'](_0x2fe31d(0x15b,'xuI#'));}catch(_0x2968b0){console[_0x2fe31d(0x1ab,'YKKE')]('‚ùå\x20ËÑöÊú¨ËøêË°åÈÅáÂà∞‰∫ÜÈîôËØØ\x0a'+_0x2968b0);}}async function handleResponse(_0x4f4ee9,_0x5a3e12){const _0x2c2078=_0x5a268b;try{switch(_0x4f4ee9){case _0x2c2078(0x1b0,'IezD'):if(_0x5a3e12[_0x2c2078(0x18a,'J7]Z')]==='0')$[_0x2c2078(0x18e,'eLK7')]=_0x5a3e12[_0x2c2078(0x1a8,'K%9y')];else _0x5a3e12['code']==='1'?console['log'](_0x2c2078(0x174,'8JZU')):console[_0x2c2078(0x14c,'NCMT')]('‚ùì'+_0x4f4ee9+'\x20'+JSON[_0x2c2078(0x147,'IZ9Y')](_0x5a3e12));break;}}catch(_0x41d8a8){console[_0x2c2078(0x168,'Owh4')](_0x2c2078(0x19a,'xuI#')+_0x4f4ee9+_0x2c2078(0x135,'8JZU')+(_0x41d8a8[_0x2c2078(0x182,'6)RL')]||_0x41d8a8));}}function _0x5084(){const _0x5df433=['5lUe6lclW7dWSykU','WRJdNCoFeSk2tYHZ','tG5RmSoPtCkDi8oBW6Cm','WPJdPJW','bsyebSo5W7y','vsrKFrzgWQa','WQ3cNSkyWQRdHW','uY0SW5uowW','WOb4W7/cO8omW4RdMYZcSSk8W4q','W79JyfDPjNBdLCkU','uSo/rdRdMCk0W7pcTxnzW6TpWP5G','WPXMEmo9aCkBW6S','5lUL5Pw85PwO5yAuEa','WR4eW5K','W7ZcQ1q','AmoQgNLlo8kDCq','6lAO5y+o5PAr5PAy','uW5RmG','hL0SW7qZbrq','WR/dKCoWemklwG','W6pcSvaWW5qwW60','6k205y+H5l+d55wr5lMu6lgO','W6VdNuazmc/dVZK','vtOQW5bmd8kRW6pdPtWtWPa8WRZcOmoZAG','c2bLDJrDWRbH','WOvKW7FcTa','WPDzbSokwSoH','umkqALxdON3dGxqrWRC','W6xcMxVdHW','5PYq5P606k+Y5yIl5lQW5PEc5lMR6lgD5y6K5yU95PUI57MA5PwE5O6l772R5B275y+z5y+/5lIn5RAR5yMb6i6+5y2H5zk6WRK','WOpcQmodW5DgWR7cRmorm8kDF2O','tGPYfmkRtCkei8oz','5lUK5Pwf5Psx5ywPDW','W4dcVwZdLIRdTeKstSoomq','Acqpg8oc','W63dMZbBFsJdNXnAvCkf','WOvdaJ8d','b10SW7m','W5tcON1F','dLXfi8k9rSkigq','oCkPWQG6tWCF','mSo0twVdISoPvCkVpmkyxM41','WPRdPIW','W4rpW4i','gSkQzSohBmoYW4VcICkQu8kHWPiP','W5jtW4L2','DYPf','aCkTx8klWQxdMSoblSo+fgCsrG','W7mPWQXKfSk7W4BdNmobtrNcNZu','oCk/WOL6WOZdSti','W5RdV8kuWOmxW77cKG','44c/5O2j56wK44oG6k6V5yAo6i2m5yYOWQbDWOpcVW5A','WPLsaCoLBCoD','WOj5W7VcPColW4a','5P2h6k+e5B645BIM','WOLvdY4','8koQK38','WQ3cRmo1WQ4h','wb10omk2','WOLXESo2o8kJW6FcH8oZumoOWOG','WRu0WQqO','WOOsEf/cUWdcKJSwWOFcGW','WQ50W5a','W7FcQmoYW5pcM8oYW4VdMmkKWQ4','W7DGwL9Hwa','WOn4W7tcLmoqW5C','Bs8fgCooWOO','W4FcUr9lBSkFhg0','hqFdT8k+WOPWWRi','W5btW5rBAga','CgRdRMK','W7VdSSkZW6HmteLpWQpcPce','WQD+W7udyG','W7PbW5y3eSkD','frtdOCkJWP9AWRy/W63cMCoepG','WQvTW744v8odWPldOSoyysVcJG','A1BcPCoH','pSkOWOq4wWuisYpcNZhdT33cJSodW68HW77dU8kXW5a','W5lcTMVdSdhdMe0uqmoXnCofW5S0','W4FcOMbo','W7lcLMJcVCk+b8ovW5vgDW','WOBdTZejzeRcMSoNv8oXWOJdPh4','WRxdPIvrtSkKoJJdQGWKWPG','l2uEcSotWO44b8kvBSoUWQxcH8oCamksWQddV8kha3ZcGmkNBCoUW6ZdGq','W7dcISoxWO8WxuO','WRxcI3aEkcZdVq','vSo1xHddN8k0','WRFcHx7dR8otg8oh','WRRdM8oB','B8kNfZW','uSo/rdZdS8kq','pIjHmrlcNSoLW4v4jq','4P22CEACUUIdHUASMEEHIEwNG+EqNvW','W4ldU8ksWOi8W7NcJa','4P66WQNMNAhNN4dOR5ZMSOHU','WQZINOSY','cSohorxdUY7dOf8VWPrOqa','CLhdRmomAb7dOSoWuGtcUCkCCbTjEmoHW7SYpuHqWRFcIdZdNqRdI3VcHM/dHupdVcHWW4vosmk6imo6WQddVwq','ktD5oq8','W5OzxMLlWPfKCCkujHhcRvy','jSkPWQSLtWmF','5lQc6loMgpc7OAe','WQKUWRa','g0WRW7CHwf7dJM7cJctcLmkjf8oOfmkpjwFdL1fXkgmbg8kgW7jWW4ldLIFcJ8okWOqsW4TIiSofBcVdHmow','W4BcVvS','W5bdW4TRy3FdTW','WOzUCCo/c8klW7lcLCoPxCodWOtcPfu','W7lcIgpdJ8kN','W6xcH33cQmkIga','uqbH','A1BcS8o3','bapdPSkHWO4','xtrKDH9uWRr6gZa','W5VORPdMSz/LPjZOT6Xz4P2lAEAwHowqPEw5PEAvL+AoOG','CCoWW4i+W6lcVKZdVCkeW6u','E8otxCoHgCkLpmof','W5TkfmkIxbxcUZO','wCkqBKVcI3NdMxWoWR4','g8k1wHldTCk8W7xcSeLi','WPTbemobxmoyzmoNamo5pCkT','W7pcNx/dISkYb8o7','WOlOR5hMS7JLK5pLUPiK','zmkOda','W7rWWQinW5LNy04','W6jZu0TWtG','hCktdSkHzCkxbCo1Dmkxsa','dYOgfCoOW6W','WQpdHI/dQSoJcmoEW4v+ymkt','gWFdVCk+','WP9AgSoArSoH'];_0x5084=function(){return _0x5df433;};return _0x5084();}async function sendRequest(_0x2534fe){const _0x1ad2e4=_0x5a268b;if($[_0x1ad2e4(0x17f,'eF@Z')]||$[_0x1ad2e4(0x143,'xuI#')])return;let _0x47fd2e='',_0x145785=null,_0x1d45a7=null,_0x54934a=_0x1ad2e4(0x1a6,'[KWG');switch(_0x2534fe){case _0x1ad2e4(0x17d,'wCJ$'):_0x47fd2e=_0x1ad2e4(0x1a5,'jZ0N'),_0x1d45a7={'page':$[_0x1ad2e4(0x19b,'eS#P')]};break;default:console[_0x1ad2e4(0x196,'u3Z^')](_0x1ad2e4(0x19c,'Owh4')+_0x2534fe);return;}const _0x298bcf={'url':_0x47fd2e,'method':_0x54934a,'headers':{'Accept':'application/json,\x20text/plain,\x20*/*','Accept-Encoding':_0x1ad2e4(0x155,'@MbU'),'Accept-Language':_0x1ad2e4(0x19f,'J7]Z'),'Connection':_0x1ad2e4(0x159,'%NuK'),'Content-Type':'application/x-www-form-urlencoded','J-E-H':$['JEH'],'J-E-C':$[_0x1ad2e4(0x17c,'lAhK')],'Cookie':cookie,'Sec-Fetch-Dest':_0x1ad2e4(0x177,'Sd0J'),'Sec-Fetch-Mode':_0x1ad2e4(0x1ac,'J7]Z'),'Sec-Fetch-Site':_0x1ad2e4(0x140,'YKKE'),'User-Agent':$['UA']},'params':_0x1d45a7,'data':_0x145785,'timeout':0x7530};_0x54934a==='GET'&&(delete _0x298bcf['data'],delete _0x298bcf[_0x1ad2e4(0x170,'eS#P')][_0x1ad2e4(0x190,'Owh4')]);const _0x545efc=0x1;let _0xfe9933=0x0,_0x53bedc=null,_0x4e03bd=![];while(_0xfe9933<_0x545efc){_0xfe9933>0x0&&await $[_0x1ad2e4(0x184,'Pf)m')](0x3e8);const _0x3d0e62=await common[_0x1ad2e4(0x1a7,'8JZU')](_0x298bcf);if(!_0x3d0e62[_0x1ad2e4(0x152,'NCMT')]){_0x53bedc='üö´\x20'+_0x2534fe+'\x20ËØ∑Ê±ÇÂ§±Ë¥•\x20‚ûú\x20'+_0x3d0e62[_0x1ad2e4(0x178,'YKKE')],_0xfe9933++;_0x3d0e62[_0x1ad2e4(0x173,'eF@Z')]&&_0x3d0e62[_0x1ad2e4(0x1aa,'eLK7')]===0x193&&($[_0x1ad2e4(0x17b,'yvSv')]=!![]);continue;}if(!_0x3d0e62[_0x1ad2e4(0x15a,'[KWG')]){_0x53bedc=_0x1ad2e4(0x176,'jZ0N')+_0x2534fe+_0x1ad2e4(0x1af,'yvSv'),_0xfe9933++;continue;}await handleResponse(_0x2534fe,_0x3d0e62['data']),_0x4e03bd=![];break;}_0xfe9933>=_0x545efc&&(console[_0x1ad2e4(0x168,'Owh4')](_0x53bedc),_0x4e03bd&&($['outFlag']=!![],$[_0x1ad2e4(0x195,'2vhY')]&&$[_0x1ad2e4(0x166,'s(E8')][_0x1ad2e4(0x169,'8JZU')](_0x53bedc)));}

// prettier-ignore
function Env(t, e) { "undefined" != typeof process && JSON.stringify(process.env).indexOf("GITHUB") > -1 && process.exit(0); class s { constructor(t) { this.env = t } send(t, e = "GET") { t = "string" == typeof t ? { url: t } : t; let s = this.get; return "POST" === e && (s = this.post), new Promise((e, i) => { s.call(this, t, (t, s, r) => { t ? i(t) : e(s) }) }) } get(t) { return this.send.call(this.env, t) } post(t) { return this.send.call(this.env, t, "POST") } } return new class { constructor(t, e) { this.name = t, this.http = new s(this), this.data = null, this.dataFile = "box.dat", this.logs = [], this.isMute = !1, this.isNeedRewrite = !1, this.logSeparator = "\n", this.startTime = (new Date).getTime(), Object.assign(this, e), this.log("", `üîî${this.name}, ÂºÄÂßã!`) } isNode() { return "undefined" != typeof module && !!module.exports } isQuanX() { return "undefined" != typeof $task } isSurge() { return "undefined" != typeof $httpClient && "undefined" == typeof $loon } isLoon() { return "undefined" != typeof $loon } toObj(t, e = null) { try { return JSON.parse(t) } catch { return e } } toStr(t, e = null) { try { return JSON.stringify(t) } catch { return e } } getjson(t, e) { let s = e; const i = this.getdata(t); if (i) try { s = JSON.parse(this.getdata(t)) } catch { } return s } setjson(t, e) { try { return this.setdata(JSON.stringify(t), e) } catch { return !1 } } getScript(t) { return new Promise(e => { this.get({ url: t }, (t, s, i) => e(i)) }) } runScript(t, e) { return new Promise(s => { let i = this.getdata("@chavy_boxjs_userCfgs.httpapi"); i = i ? i.replace(/\n/g, "").trim() : i; let r = this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout"); r = r ? 1 * r : 20, r = e && e.timeout ? e.timeout : r; const [o, h] = i.split("@"), n = { url: `http://${h}/v1/scripting/evaluate`, body: { script_text: t, mock_type: "cron", timeout: r }, headers: { "X-Key": o, Accept: "*/*" } }; this.post(n, (t, e, i) => s(i)) }).catch(t => this.logErr(t)) } loaddata() { if (!this.isNode()) return {}; { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e); if (!s && !i) return {}; { const i = s ? t : e; try { return JSON.parse(this.fs.readFileSync(i)) } catch (t) { return {} } } } } writedata() { if (this.isNode()) { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e), r = JSON.stringify(this.data); s ? this.fs.writeFileSync(t, r) : i ? this.fs.writeFileSync(e, r) : this.fs.writeFileSync(t, r) } } lodash_get(t, e, s) { const i = e.replace(/\[(\d+)\]/g, ".$1").split("."); let r = t; for (const t of i) if (r = Object(r)[t], void 0 === r) return s; return r } lodash_set(t, e, s) { return Object(t) !== t ? t : (Array.isArray(e) || (e = e.toString().match(/[^.[\]]+/g) || []), e.slice(0, -1).reduce((t, s, i) => Object(t[s]) === t[s] ? t[s] : t[s] = Math.abs(e[i + 1]) >> 0 == +e[i + 1] ? [] : {}, t)[e[e.length - 1]] = s, t) } getdata(t) { let e = this.getval(t); if (/^@/.test(t)) { const [, s, i] = /^@(.*?)\.(.*?)$/.exec(t), r = s ? this.getval(s) : ""; if (r) try { const t = JSON.parse(r); e = t ? this.lodash_get(t, i, "") : e } catch (t) { e = "" } } return e } setdata(t, e) { let s = !1; if (/^@/.test(e)) { const [, i, r] = /^@(.*?)\.(.*?)$/.exec(e), o = this.getval(i), h = i ? "null" === o ? null : o || "{}" : "{}"; try { const e = JSON.parse(h); this.lodash_set(e, r, t), s = this.setval(JSON.stringify(e), i) } catch (e) { const o = {}; this.lodash_set(o, r, t), s = this.setval(JSON.stringify(o), i) } } else s = this.setval(t, e); return s } getval(t) { return this.isSurge() || this.isLoon() ? $persistentStore.read(t) : this.isQuanX() ? $prefs.valueForKey(t) : this.isNode() ? (this.data = this.loaddata(), this.data[t]) : this.data && this.data[t] || null } setval(t, e) { return this.isSurge() || this.isLoon() ? $persistentStore.write(t, e) : this.isQuanX() ? $prefs.setValueForKey(t, e) : this.isNode() ? (this.data = this.loaddata(), this.data[e] = t, this.writedata(), !0) : this.data && this.data[e] || null } initGotEnv(t) { this.got = this.got ? this.got : require("got"), this.cktough = this.cktough ? this.cktough : require("tough-cookie"), this.ckjar = this.ckjar ? this.ckjar : new this.cktough.CookieJar, t && (t.headers = t.headers ? t.headers : {}, void 0 === t.headers.Cookie && void 0 === t.cookieJar && (t.cookieJar = this.ckjar)) } get(t, e = (() => { })) { t.headers && (delete t.headers["Content-Type"], delete t.headers["Content-Length"]), this.isSurge() || this.isLoon() ? (this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.get(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) })) : this.isQuanX() ? (this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t))) : this.isNode() && (this.initGotEnv(t), this.got(t).on("redirect", (t, e) => { try { if (t.headers["set-cookie"]) { const s = t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString(); s && this.ckjar.setCookieSync(s, null), e.cookieJar = this.ckjar } } catch (t) { this.logErr(t) } }).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) })) } post(t, e = (() => { })) { if (t.body && t.headers && !t.headers["Content-Type"] && (t.headers["Content-Type"] = "application/x-www-form-urlencoded"), t.headers && delete t.headers["Content-Length"], this.isSurge() || this.isLoon()) this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.post(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) }); else if (this.isQuanX()) t.method = "POST", this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t)); else if (this.isNode()) { this.initGotEnv(t); const { url: s, ...i } = t; this.got.post(s, i).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) }) } } time(t, e = null) { const s = e ? new Date(e) : new Date; let i = { "M+": s.getMonth() + 1, "d+": s.getDate(), "H+": s.getHours(), "m+": s.getMinutes(), "s+": s.getSeconds(), "q+": Math.floor((s.getMonth() + 3) / 3), S: s.getMilliseconds() }; /(y+)/.test(t) && (t = t.replace(RegExp.$1, (s.getFullYear() + "").substr(4 - RegExp.$1.length))); for (let e in i) new RegExp("(" + e + ")").test(t) && (t = t.replace(RegExp.$1, 1 == RegExp.$1.length ? i[e] : ("00" + i[e]).substr(("" + i[e]).length))); return t } msg(e = t, s = "", i = "", r) { const o = t => { if (!t) return t; if ("string" == typeof t) return this.isLoon() ? t : this.isQuanX() ? { "open-url": t } : this.isSurge() ? { url: t } : void 0; if ("object" == typeof t) { if (this.isLoon()) { let e = t.openUrl || t.url || t["open-url"], s = t.mediaUrl || t["media-url"]; return { openUrl: e, mediaUrl: s } } if (this.isQuanX()) { let e = t["open-url"] || t.url || t.openUrl, s = t["media-url"] || t.mediaUrl; return { "open-url": e, "media-url": s } } if (this.isSurge()) { let e = t.url || t.openUrl || t["open-url"]; return { url: e } } } }; if (this.isMute || (this.isSurge() || this.isLoon() ? $notification.post(e, s, i, o(r)) : this.isQuanX() && $notify(e, s, i, o(r))), !this.isMuteLog) { let t = ["", "==============üì£Á≥ªÁªüÈÄöÁü•üì£=============="]; t.push(e), s && t.push(s), i && t.push(i), console.log(t.join("\n")), this.logs = this.logs.concat(t) } } log(...t) { t.length > 0 && (this.logs = [...this.logs, ...t]), console.log(t.join(this.logSeparator)) } logErr(t, e) { const s = !this.isSurge() && !this.isQuanX() && !this.isLoon(); s ? this.log("", `‚ùóÔ∏è${this.name}, ÈîôËØØ!`, t.stack) : this.log("", `‚ùóÔ∏è${this.name}, ÈîôËØØ!`, t) } wait(t) { return new Promise(e => setTimeout(e, t)) } done(t = {}) { const e = (new Date).getTime(), s = (e - this.startTime) / 1e3; this.log("", `üîî${this.name}, ÁªìÊùü! üïõ ${s} Áßí`), this.log(), (this.isSurge() || this.isQuanX() || this.isLoon()) && $done(t) } }(t, e) }
