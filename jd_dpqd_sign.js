/*
活动名称：批量店铺签到
活动链接：https://h5.m.jd.com/babelDiy/Zeus/2PAAf74aG3D61qvfKUM5dxUssJQ9/index.html?token=<token>
环境变量：jd_dpqd_tokens // 活动令牌，多个用英文逗号，@，&，换行分割
        jd_dpqd_task_threads // 控制签到并发线程数（正整数），默认1
        jd_dpqd_account_threads // 控制账号并发线程数（正整数），默认1
        jd_dpqd_account_interval // 自定义运行间隔时长（整数，单位毫秒），默认0
        jd_dpqd_max_retry // 签到火爆时的最大重试次数（整数），默认0
        jd_dpqd_prize_notify // 是否推送中奖信息（true/false），默认不推送

此脚本为高并发签到本，需要读取主脚本生成的活动信息缓存，自动过滤无效活动，签到后如有奖品则自动到账


cron:1 1 1 1 *

*/

const $ = new Env('批量店铺签到')
const _0x3be6ab=_0x5429;(function(_0x2644fc,_0x2dcb70){const _0x5d6f48=_0x5429,_0x461c4b=_0x2644fc();while(!![]){try{const _0x557b2c=parseInt(_0x5d6f48(0x283,'H^fN'))/0x1*(-parseInt(_0x5d6f48(0x235,'tD(9'))/0x2)+-parseInt(_0x5d6f48(0x27b,'yctG'))/0x3*(-parseInt(_0x5d6f48(0x1ef,'f6FK'))/0x4)+-parseInt(_0x5d6f48(0x278,'yctG'))/0x5*(parseInt(_0x5d6f48(0x24b,'W1FE'))/0x6)+-parseInt(_0x5d6f48(0x281,'!o&U'))/0x7+-parseInt(_0x5d6f48(0x25d,'^oO!'))/0x8*(-parseInt(_0x5d6f48(0x265,'2Pp3'))/0x9)+-parseInt(_0x5d6f48(0x203,'1XC4'))/0xa*(parseInt(_0x5d6f48(0x225,'I8pV'))/0xb)+-parseInt(_0x5d6f48(0x230,'V]5$'))/0xc*(-parseInt(_0x5d6f48(0x1fa,'Xl%W'))/0xd);if(_0x557b2c===_0x2dcb70)break;else _0x461c4b['push'](_0x461c4b['shift']());}catch(_0x26f233){_0x461c4b['push'](_0x461c4b['shift']());}}}(_0x54c1,0x25064));const jdCookie=require(_0x3be6ab(0x23a,'4m(4')),notify=require('./utils/Rebels_sendJDNotify'),common=require(_0x3be6ab(0x237,'W1FE')),{H5st}=require(_0x3be6ab(0x1f1,'Vsep'));let tokensList=(process['env']['jd_dpqd_tokens']||'')['split'](/[,@&|\n]+/g)['filter'](Boolean),taskThreads=process[_0x3be6ab(0x20e,'^oO!')][_0x3be6ab(0x220,'*)[c')]||'1',accountThreads=process[_0x3be6ab(0x234,'%UW*')]['jd_dpqd_account_threads']||'1';const runInterval=process[_0x3be6ab(0x207,'xB&n')][_0x3be6ab(0x1e8,'8AuT')]||'';let signHotMaxRetryTimes=process['env'][_0x3be6ab(0x24a,'!o&U')]||'0';function _0x5429(_0x25171b,_0x29d3a3){const _0x54c1cb=_0x54c1();return _0x5429=function(_0x542934,_0x326054){_0x542934=_0x542934-0x1de;let _0x3f1d75=_0x54c1cb[_0x542934];if(_0x5429['sLFbAe']===undefined){var _0x4d71cc=function(_0x4e499c){const _0x55bb97='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x48cc9b='',_0x2401ca='';for(let _0x6b9794=0x0,_0x2d4d62,_0x1dc5eb,_0x298a79=0x0;_0x1dc5eb=_0x4e499c['charAt'](_0x298a79++);~_0x1dc5eb&&(_0x2d4d62=_0x6b9794%0x4?_0x2d4d62*0x40+_0x1dc5eb:_0x1dc5eb,_0x6b9794++%0x4)?_0x48cc9b+=String['fromCharCode'](0xff&_0x2d4d62>>(-0x2*_0x6b9794&0x6)):0x0){_0x1dc5eb=_0x55bb97['indexOf'](_0x1dc5eb);}for(let _0x2e35fe=0x0,_0x451db0=_0x48cc9b['length'];_0x2e35fe<_0x451db0;_0x2e35fe++){_0x2401ca+='%'+('00'+_0x48cc9b['charCodeAt'](_0x2e35fe)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x2401ca);};const _0x490176=function(_0x463469,_0x1a3f3f){let _0x17a179=[],_0x38d13b=0x0,_0x4eff6d,_0x3f9432='';_0x463469=_0x4d71cc(_0x463469);let _0x26f03f;for(_0x26f03f=0x0;_0x26f03f<0x100;_0x26f03f++){_0x17a179[_0x26f03f]=_0x26f03f;}for(_0x26f03f=0x0;_0x26f03f<0x100;_0x26f03f++){_0x38d13b=(_0x38d13b+_0x17a179[_0x26f03f]+_0x1a3f3f['charCodeAt'](_0x26f03f%_0x1a3f3f['length']))%0x100,_0x4eff6d=_0x17a179[_0x26f03f],_0x17a179[_0x26f03f]=_0x17a179[_0x38d13b],_0x17a179[_0x38d13b]=_0x4eff6d;}_0x26f03f=0x0,_0x38d13b=0x0;for(let _0x5a37fa=0x0;_0x5a37fa<_0x463469['length'];_0x5a37fa++){_0x26f03f=(_0x26f03f+0x1)%0x100,_0x38d13b=(_0x38d13b+_0x17a179[_0x26f03f])%0x100,_0x4eff6d=_0x17a179[_0x26f03f],_0x17a179[_0x26f03f]=_0x17a179[_0x38d13b],_0x17a179[_0x38d13b]=_0x4eff6d,_0x3f9432+=String['fromCharCode'](_0x463469['charCodeAt'](_0x5a37fa)^_0x17a179[(_0x17a179[_0x26f03f]+_0x17a179[_0x38d13b])%0x100]);}return _0x3f9432;};_0x5429['FOgjre']=_0x490176,_0x25171b=arguments,_0x5429['sLFbAe']=!![];}const _0x5e1e43=_0x54c1cb[0x0],_0x353670=_0x542934+_0x5e1e43,_0x467e51=_0x25171b[_0x353670];return!_0x467e51?(_0x5429['cVEILX']===undefined&&(_0x5429['cVEILX']=!![]),_0x3f1d75=_0x5429['FOgjre'](_0x3f1d75,_0x326054),_0x25171b[_0x353670]=_0x3f1d75):_0x3f1d75=_0x467e51,_0x3f1d75;},_0x5429(_0x25171b,_0x29d3a3);}const isNotify=process[_0x3be6ab(0x25c,'G3o$')][_0x3be6ab(0x258,']G&]')]===_0x3be6ab(0x1f2,'2Pp3');let TokensMap=new Map();const signStatusMessages={0x1805c007:'今日已签',0x181688ea:_0x3be6ab(0x22d,'Vsep'),0x1843da61:_0x3be6ab(0x247,'@V9q'),0x1843da62:_0x3be6ab(0x262,'o9ym'),0x184253c7:'账号无效',0x192:'活动无效','-1':_0x3be6ab(0x1e6,'V]5$')},invalidTokensMap=new Map(),CacheFile=__dirname+_0x3be6ab(0x241,'H^fN'),cookiesArr=Object[_0x3be6ab(0x1eb,'kZj4')](jdCookie)[_0x3be6ab(0x243,'%UW*')](_0x490176=>jdCookie[_0x490176])['filter'](_0x4e499c=>_0x4e499c);function _0x54c1(){const _0x231523=['rdtcNCogWP3dI3xcKmkZCa','WO41pSooW4NcRCk9v8kfWR0iy8kU','W6hdVCkQxG','C8kLW47cHG','WPtdTK0GFCkKm8kZhSoohq','56ECWQ/OV5FOOOhPLAJPMQBMLAVPLiW','5yA357Ud5yYQ8yogJa','4P6gW4BOHQNMNiZOVlZOOz3PGy/LI6hKUAtPL5JORlFdRG','tmouWQVdHa','WQLQuq','crxcUSoRW4lcMq','5P2E5yQz5zMo57Qa5B6G','dMtcMW','zmkwwmkPW6XdW7KSWQddOL4sWQChW5LYW6mbdbJdSCoUWQ5C','4P+BW4BMNk3OGR3MR6JNOjVLPOxNKAxcSW','w8obWOhdGSkdW6hdSmkskCoIWRvAWPhdRW','WQnJrmkL','W7ToWP09tW','WR9NvmkIxXfJDq','W7pcJ3qJW6qaW68x','E8kFcSk1W47cNHzueCkOW6ajWRq','hmk7WRNcHCkZWRC','fdBcUCoSWR1Sxhj1iXhcGSkqWPpcOc0','qbhcQaC','WQSvrsPeo1X8yHNdJGJdVSk5W5u','BSoWBG','a8o3m0LAbSoMW6/dUSkU','WOrGfmk6','a8oRjSkz','W41rsSk3oHGPWQ8','WQOzqYbbpvX1vapdLcW','WQ8DW4TqpZnajSkzWPbE','hmopW7Ps','WQiudWDjEeP4kJldMYhdPmoKW5aGW5qEW5S','5yYQ6ywa5B2Z5zcH54IO5Oo+W5b7W6fjaw7dPCkXySou','vSk2EW','fgZcNmoVj8kuymoL','wJ1f','A8kZW5K','W4TID8kkW5xdR8oLxCkuWOm','WRVcOSkRFSoPWPNcUCoJ','BxVcU8oxjunYzJhdPNmW','x8ooWRZdIq','WO1Ke8kOW5C8mG','W53cVcm','hSkXWQa','fHNcRW','uJ3dJmkSrCoex8oZn2eIW7y','WQxcO10fW7GNW7m','W6tcK2qJW64gW7i','hUkDL8ks6kY/5RkU5Awk6lAX77YZ5Ps55zoR5BI55Pw+5OYF776Z8lQBIG','ctLV','uwtdOSoh','umk2oCkoCSojWP5K','vxhdR8osqrmpW7hdOCo6WO7cRrDXW7BcPCk5','WOVdVrpcIJTL','WPVdOqDRW6ZcVmkikmkOeu4mWQVdPddcMCopqSoqja','B8oMzWmsW7C','DSoVW5f5nHZcO8oraSoc','lCo+WPpcQZPOW4xcMG','WO7cGSk/autdJCop','buSp','5lUj6lg+8jAXOW','W7hcIxuTW6ObW5ukW74h','WOBcJLWVWQjcvvq','b2mqW47cLCkUqKpdPetdPCkE','6zEi6zI15PsU6zEtfutcJW','W7pcH3mH','WP7dObq','wg/dMCoghuipW4VdS8o3WPZcSI0PWR7cTCkUuYy6','e3K2','772d8lskKa','WOhdPXPOW6O','WPtdQbhcHdS','W4pcV0O5WQJdHSk/nCkDpKKh','WOZdVgi','hCk/WQC','txJcPCoSWObPqJG','WQRdMZP9WRziWRXEWQ5F','oSkwzSo+WQ8','W49YFmkw','4PU/AUIfP+wTVUs5LEI+PoIHIUMxP+MBO+AvVoMvJEIVPUE9L+MwGoIVSq','5BEi6l6N5yU856+M5yUK5lIk6zM/','xcfnWPddKSkVoJZcSq','WRvhW6tdIwPmWObYAWTmW7pdStddRq','yGKqW7umW6xcLd4sdq','t8oiWR/dGMWlWRH6W63cJ0GchCkHjG','44gL5O+v56Ar44oJ6kYF5yEU6i6A5yYUWQjrW4rbpCkn','cmoUn18','WPepwq','W53cPwugWQr0qG','adj3eXCJ','lCkSFbapW7mUW71uDSkfW6G5qSoRoCkKkdZdUYWJxW','5lQg55c+5BYM5ysMWPBdGci','ps/cGaKTW5q','CwxdP8kaxXTPEb7dRW','mSopta','fNFdJSktWPZdGW','utDw','ks/dO8kaEqzpDW','W6XzWPOsAYzLeSkN','4PUjboIUN+wfOowVG+s7L+w+QoILL+EBK+EmPowJR+wpPoMhO+wsOUwfM+I+NEIHNEIeN+AFL++9Pq','rLyBDZ3dRHZcSGJdVWnxsCocWQvJE3BcLaO','A8k5W5dcHaPL','WPKaxW','vmkKW5VcPG','oSozzmo1WPtdGG','wd0pWP3dJCoSEq','5RA55yIU5Bcm5PYE5B6a5Awe','F8k+ymoKkmkmwG','W7v1WPirWOy5dt0CjCkDjZmP','WRtcQ8kdcfqXjvRdGq5MzYFcQSk5ox0','n8k7qamtW64hWQC','pComuSoXWQNdHu9A','WPddObXIW7VcNSkd','WRC9W7i','5y6I6yA554M+5Okd57MH5P6YW6NdHCotkalcIf/dIIRcVa','fmobW6K','k8oDuSkRWPdcGKHBr8kBW5Wl','fvLujSoj','W77INzpdVokDQqq','h8olW7O','WR4qtsT1','WRyDtYe','WPWvw8kcgenmW5ldQLXbWQPsc17dOCopW4/dT8oggSkNW6tcQW','uZjdDblcJZKOumkNsfZcQCoyWOxcJbz0f2W','W4XwhmofwXGpWOJdMwvh','W7K2CmkJWOunl2K','oCo+WO7cVay','wCokWOm','w2vObHSftHO','rCktWRmoWOK/WP5atIy','a8k7WQm','W5/cTYenW6JcOt7dJ1qK','DSkjgCo2ga','5REB5yQP5BAs57Iu57ML5PYe','W77INzpdVoIUM+AXPUwLSEI1Po+8Jq','cmoBW71B','b1BdPvVdMCkxB8o7AMPO','t8oqWPtdOmkfW73dN8kcdSo+','WQGMW7rwkfVcTCkuW5VdRW','ySkDya','vFcEGim','bLDcma','wJDmWPNdLSo2','W7xdS8kNtW','W6BdP2jv','WOXUbW','WQFcLCou','z8kCzmkHW6LwW7Ga','6ygI552l5OYM6ycYWO4IW7G','6lES5yYr5Pwt5PwOW4ZWM4QJ','z8kCC8kOW65tW74hWPhdS1qhWRC6W4zyW4ygcWK','5yw9WO7LJ5pXJy2T','w8kZW5VcVa','w8obWOhdKCkEW6hdO8kch8oaWRvcWPhdUq','i+kCNYNINAfg','WQjUlCo3W6enmhDfWPHZ','W6TkWPOC','pCoep8o1WQ1RW5e0WOVdQeq','WQKPwSk0WOulhW','5l6k5OoW5yUE8kIeUo+5Kq','fokFV8o94PYUW4S','WRRdH0LJW7pdHCkEnCoYjW','E8oJW4i','imkHqW','W6/dVSoUxbnWcuRdIITKCq','5BQu6zg556EM5yMI8kASGo+5KG','wXvEg2dcQrNcOXhdPY1u','tK7cGCoLW4FcNmkoWO0'];_0x54c1=function(){return _0x231523;};return _0x54c1();}!cookiesArr[0x0]&&($[_0x3be6ab(0x26f,')8fQ')]($[_0x3be6ab(0x256,'9k7$')],_0x3be6ab(0x232,'dC&G')),process[_0x3be6ab(0x275,'YA^g')](0x1));!(async()=>{const _0x47da63=_0x3be6ab;try{console[_0x47da63(0x209,'oJMY')](_0x47da63(0x25e,'@OfE')+$[_0x47da63(0x233,'V!nV')]+_0x47da63(0x1fd,'I8pV')),console[_0x47da63(0x24e,'ty61')]('活动令牌:\x20['+tokensList['join'](',\x20')+']'),console['log'](_0x47da63(0x238,'@R1e')+common[_0x47da63(0x1ea,'G3o$')]()+']'),console['log'](_0x47da63(0x21d,'WTZ0')+runInterval/0x3e8+_0x47da63(0x1e0,'8AuT')),console[_0x47da63(0x250,'@OfE')]('签到火爆时的最大重试次数:\x20['+signHotMaxRetryTimes+']'),console[_0x47da63(0x21f,'I8pV')](_0x47da63(0x271,'@OfE')+(isNotify?'开启':'关闭')+']'),console[_0x47da63(0x280,'[yDY')](_0x47da63(0x229,'uI#y')+$['name']+_0x47da63(0x24f,'oJMY')),console['log'](''),notify['config']({'title':$['name']});if(tokensList['length']>0x0)tokensList=[...new Set(tokensList['filter'](_0x48cc9b=>_0x48cc9b!==''))];if(tokensList[_0x47da63(0x242,'nINz')]<=0x0){console[_0x47da63(0x26e,'o9ym')](_0x47da63(0x240,'H^fN'));return;}const _0x55bb97=require('fs');if(_0x55bb97[_0x47da63(0x1f5,'V!nV')](CacheFile)){const _0x2401ca=_0x55bb97[_0x47da63(0x1f9,'9k7$')](CacheFile,_0x47da63(0x261,'$28&')),_0x6b9794=JSON[_0x47da63(0x252,'@R1e')](_0x2401ca);for(const _0x2d4d62 in _0x6b9794){TokensMap[_0x47da63(0x25f,'&Jer')](_0x2d4d62,_0x6b9794[_0x2d4d62]);}}$[_0x47da63(0x1ed,'kZj4')]=null;if(runInterval)try{const _0x1dc5eb=parseInt(runInterval);_0x1dc5eb>=0x0&&($['waitTime']=_0x1dc5eb);}catch{console[_0x47da63(0x27f,'Bi9&')](_0x47da63(0x22c,'4m(4'));}try{const _0x298a79=parseInt(signHotMaxRetryTimes);signHotMaxRetryTimes=_0x298a79>0x0?_0x298a79:0x0;}catch{signHotMaxRetryTimes=0x3;}try{const _0x2e35fe=parseInt(taskThreads);_0x2e35fe>0x0&&_0x2e35fe!==0x1&&(taskThreads=_0x2e35fe);}catch{taskThreads=0x1;}try{const _0x451db0=parseInt(accountThreads);_0x451db0>0x0&&_0x451db0!==0x1&&(accountThreads=_0x451db0);}catch{accountThreads=0x1;}await common[_0x47da63(0x25a,'yctG')](accountThreads,cookiesArr,async(_0x463469,_0x1a3f3f)=>{const _0x1ee781=_0x47da63;await concMain(taskThreads,tokensList,_0x463469,_0x1a3f3f,Main);if($[_0x1ee781(0x216,'F)x)')])await $[_0x1ee781(0x279,'Xl%W')]($[_0x1ee781(0x24c,'f6FK')]);}),isNotify&&notify[_0x47da63(0x260,'xB&n')]()&&await notify[_0x47da63(0x264,'@OfE')]();}catch(_0x17a179){console['log'](_0x47da63(0x1e2,')8fQ')+_0x17a179);}})()[_0x3be6ab(0x25b,'F)x)')](_0x38d13b=>$['logErr'](_0x38d13b))['finally'](()=>$[_0x3be6ab(0x1f7,'hNN6')]());async function Main(_0x4eff6d,_0x3f9432){const _0x4d585e=_0x3be6ab,{title:_0x26f03f,UA:_0x5a37fa,cookie:_0x5628d9,message:_0x848abb}=_0x3f9432;if(invalidTokensMap['get'](_0x4eff6d))return;let _0x263d64='',_0x318749='';const _0x337b68=TokensMap[_0x4d585e(0x254,'@OfE')](_0x4eff6d);if(_0x337b68)_0x263d64=_0x337b68[_0x4d585e(0x23e,'4m(4')],_0x318749=_0x337b68[_0x4d585e(0x215,'Bi9&')];else try{if(_0x4eff6d[_0x4d585e(0x270,'8AuT')](':')&&_0x4eff6d['split'](':')['length']===0x3){const _0x18e637=_0x4eff6d[_0x4d585e(0x224,'7oa)')](':');if(!_0x18e637[0x0]||!_0x18e637[0x1]||!_0x18e637[0x2])return;_0x4eff6d=_0x18e637[0x0];if(_0x4eff6d[_0x4d585e(0x1f0,'&Jer')]!==0x20||!/^[A-Z0-9]*$/['test'](_0x4eff6d))return;_0x318749=_0x18e637[0x1],_0x263d64=_0x18e637[0x2],_0x18e637[0x2][_0x4d585e(0x266,'G3o$')](_0x4d585e(0x1fe,'hNN6'))&&_0x18e637[0x2][_0x4d585e(0x236,'^oO!')]===0x8&&!_0x18e637[0x1][_0x4d585e(0x267,'ty61')](_0x4d585e(0x23b,'$28&'))&&(_0x318749=_0x18e637[0x2],_0x263d64=_0x18e637[0x1]),TokensMap['set'](_0x4eff6d,{'index':null,'venderId':_0x263d64,'shopName':'','activityId':_0x318749,'startTime':'','endTime':'','isValid':!![],'rules':[],'minLevel':null,'maxLevel':null});}}catch(_0x5355bc){return;}if(!_0x263d64||!_0x318749)return;const _0x19cbee=Math[_0x4d585e(0x255,'9k7$')](Date[_0x4d585e(0x208,'&Jer')]()/0x3e8)+'000';if(invalidTokensMap['get'](_0x4eff6d))return;let _0x3cffd5=![],_0x56e577;await _0x394674(_0x4d585e(0x231,'WTZ0'));if($[_0x4d585e(0x1ff,'JXxT')])await $[_0x4d585e(0x26c,'1XC4')]($[_0x4d585e(0x216,'F)x)')]);if(_0x3cffd5&&signHotMaxRetryTimes>0x0){let _0x436c7b=0x0;while(_0x436c7b<signHotMaxRetryTimes){if(invalidTokensMap[_0x4d585e(0x23d,'b0@J')](_0x4eff6d))return;await _0x394674(_0x4d585e(0x22f,'Nx]a'));if($[_0x4d585e(0x1ed,'kZj4')])await $['wait']($[_0x4d585e(0x228,'Vsep')]);if(!_0x3cffd5)break;_0x436c7b++;}}function _0xa8acbe(_0x4441ec,_0x509980){const _0x4c80a7=_0x4d585e;try{switch(_0x4441ec){case _0x4c80a7(0x1f3,'9k7$'):if(_0x509980['code']===0xc8&&_0x509980[_0x4c80a7(0x20c,'uI#y')]===!![]){const _0x4127db=[];if(_0x509980[_0x4c80a7(0x1f6,'o9ym')]&&_0x509980['data'][_0x4c80a7(0x26b,'b0@J')]>0x0)for(const _0x520d86 of _0x509980[_0x4c80a7(0x26d,'@V9q')]){const _0x5c7860=_0x520d86?.[_0x4c80a7(0x23f,'Xl%W')]||[];for(const _0x1ebcb0 of _0x5c7860){const _0x2862e6=_0x1ebcb0?.[_0x4c80a7(0x1de,'nINz')],_0x5e355f=_0x1ebcb0?.[_0x4c80a7(0x1ee,'uI#y')];let _0x107dc0='';switch(_0x2862e6){case 0x1:_0x107dc0=_0x4c80a7(0x27c,'B3lX');break;case 0x4:_0x107dc0=_0x5e355f+_0x4c80a7(0x219,'@R1e');break;case 0x6:_0x107dc0=_0x5e355f+_0x4c80a7(0x282,'W1FE');break;case 0x9:console['log'](_0x1ebcb0),_0x107dc0=(_0x1ebcb0?.[_0x4c80a7(0x273,'8AuT')][0x0]?.['skuName']||'未知')+'🎁';break;case 0xa:_0x107dc0=_0x5e355f+_0x4c80a7(0x274,'YA^g');break;case 0xe:_0x107dc0=_0x5e355f/0x64+_0x4c80a7(0x1e1,'%UW*');break;default:_0x107dc0='未知奖品（'+_0x2862e6+'）';}_0x4127db[_0x4c80a7(0x1e3,'WTZ0')](_0x107dc0);}}if(_0x4127db['length']>0x0){console[_0x4c80a7(0x268,'8AuT')](''+_0x26f03f+_0x4eff6d+_0x4c80a7(0x253,'!o&U')+_0x56e577+'\x20'+_0x4127db[_0x4c80a7(0x244,'YA^g')]('，'));for(const _0x43d0e3 of _0x4127db){_0x848abb['insert'](_0x43d0e3);}}else console['log'](''+_0x26f03f+_0x4eff6d+_0x4c80a7(0x277,'W1FE')+_0x56e577+_0x4c80a7(0x269,'dC&G'));_0x3cffd5=![];}else{if(_0x509980[_0x4c80a7(0x20f,'*)[c')]!==0xc8){const _0x5ce6ab=signStatusMessages[_0x509980[_0x4c80a7(0x26a,'@R1e')]]||_0x509980[_0x4c80a7(0x287,'1XC4')]+'|活动太火爆';[0x1843da61,0x1843da62,0x192][_0x4c80a7(0x21b,'tD(9')](_0x509980[_0x4c80a7(0x205,'WTZ0')])&&invalidTokensMap['set'](_0x4eff6d,!![]),console[_0x4c80a7(0x218,'H^fN')](''+_0x26f03f+_0x4eff6d+'\x20➜\x20❌\x20'+_0x56e577+'\x20'+_0x5ce6ab),(_0x509980[_0x4c80a7(0x26a,'@R1e')]==='-1'||_0x509980['code']===-0x1)&&(_0x3cffd5=!![]);}else{if(_0x509980['msg']){console['log'](''+_0x26f03f+_0x4eff6d+_0x4c80a7(0x27d,'2Pp3')+_0x56e577+'\x20'+_0x509980[_0x4c80a7(0x1f4,'W1FE')]);if(!signStatusMessages[_0x509980['code']])_0x3cffd5=!![];}else console[_0x4c80a7(0x201,'nINz')](''+_0x26f03f+_0x4eff6d+'\x20➜\x20❌\x20'+_0x56e577+'\x20'+JSON['stringify'](_0x509980));}}break;}}catch(_0x4d3a60){console[_0x4c80a7(0x280,'[yDY')](_0x4c80a7(0x1e9,'uI#y')+_0x4441ec+'\x20请求响应\x20'+(_0x4d3a60[_0x4c80a7(0x206,'o9ym')]||_0x4d3a60));}}async function _0x394674(_0x5bcb43){const _0x14a667=_0x4d585e;let _0x1b9dee='',_0x4891a7=null,_0x4f61e8=null,_0x38968b='GET',_0x3c4ba1={},_0x26d50a={};switch(_0x5bcb43){case'signCollectGift':_0x26d50a={'appId':_0x14a667(0x22a,'8AuT'),'functionId':'interact_center_shopSign_signCollectGift','appid':_0x14a667(0x213,'I8pV'),'body':{'token':_0x4eff6d,'venderId':parseInt(_0x263d64)||'','activityId':parseInt(_0x318749)||'','type':0x38,'actionType':0x7},'version':_0x14a667(0x226,'xB&n'),'ua':_0x5a37fa},_0x3c4ba1=await H5st['getH5st'](_0x26d50a),_0x1b9dee=_0x14a667(0x257,'%UW*'),_0x4f61e8=Object['assign']({},_0x3c4ba1['paramsData'],{'jsonp':_0x14a667(0x22e,'b0@J')});break;}const _0x626156={'t':_0x19cbee,'loginType':'2'};_0x4891a7&&Object['assign'](_0x4891a7,_0x626156);_0x4f61e8&&Object[_0x14a667(0x239,'YAMy')](_0x4f61e8,_0x626156);const _0x58f04b={'url':_0x1b9dee,'method':_0x38968b,'headers':{'Accept':_0x14a667(0x221,']G&]'),'Accept-Encoding':_0x14a667(0x211,'*)[c'),'Accept-Language':_0x14a667(0x1fc,'9k7$'),'Connection':'keep-alive','Content-Type':_0x14a667(0x202,'3NfO'),'Host':_0x14a667(0x251,'f6FK'),'Referer':'https://h5.m.jd.com/','Sec-Fetch-Dest':_0x14a667(0x1e5,'oJMY'),'Sec-Fetch-Mode':_0x14a667(0x246,'b0@J'),'Sec-Fetch-Site':'same-origin','User-Agent':_0x5a37fa,'Cookie':_0x5628d9},'params':_0x4f61e8,'data':_0x4891a7,'timeout':0x7530};_0x38968b==='GET'&&(delete _0x58f04b[_0x14a667(0x1fb,'@OfE')],delete _0x58f04b['headers']['Content-Type']);const _0x41a67e=0x3;let _0x34734f=0x0,_0x20346b=null,_0x11aa04=![];while(_0x34734f<_0x41a67e){_0x56e577=common[_0x14a667(0x21a,'uI#y')](_0x14a667(0x27e,'I8pV'));const _0x31f5f4=await common['request'](_0x58f04b);if(!_0x31f5f4['success']){_0x20346b=''+_0x26f03f+_0x4eff6d+_0x14a667(0x263,'!o&U')+_0x31f5f4['error']+_0x14a667(0x222,'f6FK'),_0x34734f++;continue;}if(!_0x31f5f4[_0x14a667(0x21e,'uI#y')]){_0x20346b=''+_0x26f03f+_0x4eff6d+_0x14a667(0x20d,'YA^g'),_0x34734f++;continue;}_0xa8acbe(_0x5bcb43,_0x31f5f4['data']),_0x11aa04=![];break;}_0x34734f>=_0x41a67e&&(console[_0x14a667(0x200,'b0@J')](_0x20346b),_0x11aa04&&($[_0x14a667(0x217,'KVQq')]=!![]));}}async function concMain(_0x38c762=0x1,_0x1a0893,_0x4849e7,_0x4b9385,_0x4c8066){const _0x3d52bb=_0x3be6ab,_0xa33e35=_0x1a0893[_0x3d52bb(0x227,'&Jer')](_0x30b1e0=>_0x30b1e0),_0x39b830=decodeURIComponent(common[_0x3d52bb(0x276,'G3o$')](_0x4849e7,_0x3d52bb(0x245,'f6FK'))),_0x276321='【账号'+_0x4b9385+'】'+_0x39b830+'：',_0x3adb48=await common[_0x3d52bb(0x249,'B3lX')](_0x4849e7);if(!_0x3adb48&&typeof _0x3adb48===_0x3d52bb(0x24d,'I8pV')){console['log'](_0x276321+_0x3d52bb(0x272,')8fQ'));return;}const _0x2cdf8b=notify[_0x3d52bb(0x23c,'dC&G')](_0x4b9385,_0x39b830),_0x3fc168=common[_0x3d52bb(0x1ec,'Xl%W')](_0x39b830),_0x26d8cb={'cookie':_0x4849e7,'index':_0x4b9385,'title':_0x276321,'UA':_0x3fc168,'message':_0x2cdf8b};let _0x500d99=0x0;async function _0x1092da(_0x3db79c){await _0x4c8066(_0x3db79c,_0x26d8cb),_0x500d99--,_0xe61a23();}async function _0xe61a23(){const _0x2d3232=_0x3d52bb;while(_0x500d99<_0x38c762&&_0xa33e35[_0x2d3232(0x212,'7oa)')]>0x0){const _0x513407=_0xa33e35['shift']();_0x500d99++,await _0x1092da(_0x513407);}}const _0x4d492b=Math[_0x3d52bb(0x1e7,'JXxT')](_0xa33e35[_0x3d52bb(0x214,'W1FE')],_0x38c762),_0x9d48fe=[];for(let _0x1c9972=0x0;_0x1c9972<_0x4d492b;_0x1c9972++){const _0x1b092f=_0xa33e35[_0x3d52bb(0x223,'I8pV')]();_0x500d99++,_0x9d48fe[_0x3d52bb(0x22b,'3NfO')](_0x1092da(_0x1b092f));}await Promise[_0x3d52bb(0x1e4,'kZj4')](_0x9d48fe),_0xe61a23(),await new Promise(_0xe24771=>{const _0xf0d994=setInterval(()=>{_0x500d99===0x0&&(clearInterval(_0xf0d994),_0xe24771());},0x64);});}
// prettier-ignore
function Env(t,e){"undefined"!=typeof process&&JSON.stringify(process.env).indexOf("GITHUB")>-1&&process.exit(0);class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),n={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(n,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.post(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method="POST",this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:s,...i}=t;this.got.post(s,i).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`❗️${this.name}, 错误!`,t.stack):this.log("",`❗️${this.name}, 错误!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
